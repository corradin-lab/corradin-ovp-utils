---

title: Genetic file formats


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "01_datasets_genetic_dataset.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_datasets_genetic_dataset.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#     sorter = np.argsort(list_to_search)</span>
<span class="c1">#     index = sorter[np.searchsorted(list_to_search, query_list, sorter=sorter)]</span>
<span class="c1">#     return index</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data_catalog</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;genetic_file&#39;,
 &#39;genetic_file_common_folder&#39;,
 &#39;genetic_file_single&#39;,
 &#39;genetic_file_split_by_chrom&#39;,
 &#39;genetic_file_bgen&#39;,
 &#39;sample_file&#39;,
 &#39;geno_each_sample&#39;,
 &#39;case_geno_each_sample&#39;,
 &#39;control_geno_each_sample&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data_catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;genetic_file&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_file_path</span><span class="o">.</span><span class="n">get_full_file_path</span><span class="p">()[</span><span class="s2">&quot;case&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:MainThread:kedro.io.data_catalog:Loading data from `genetic_file` (OVPDataset)...
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/data/test_data/gen_file/test_CASE_MS_chr22.gen&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GenFileFormat" class="doc_header"><code>class</code> <code>GenFileFormat</code><a href="https://github.com/corradin-lab/corradin_ovp_utils/tree/master/ #https://github.com/hoangthienan95/corradin_ovp_utils/tree/master/corradin_ovp_utils/datasets/genetic_file/Gen.py#L41" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GenFileFormat</code>(<strong><code>file_path</code></strong>:<a href="/corradin_ovp_utils/datasets_schemas.html#SingleFilePathSchema"><code>SingleFilePathSchema</code></a>, <strong><code>prob_n_cols</code></strong>:<code>int</code>, <strong><code>initial_cols</code></strong>:<code>List</code>[<code>str</code>], <strong><code>rsid_col</code></strong>:<code>str</code>, <strong><code>alleleA_col</code></strong>:<code>str</code>, <strong><code>alleleB_col</code></strong>:<code>str</code>, <strong><code>ref_alt_delim</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>pandas_args</code></strong>:<code>Dict</code>[<code>str</code>, <code>Any</code>], <strong><code>sample_ids</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>current_file_path</code></strong>:<code>str</code>=<em><code>None</code></em>) :: <a href="/corradin_ovp_utils/datasets_genetic_file.html#GeneticFileFormat"><code>GeneticFileFormat</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_file_object_class" class="doc_header"><code>create_file_object_class</code><a href="https://github.com/corradin-lab/corradin_ovp_utils/tree/master/ #https://github.com/hoangthienan95/corradin_ovp_utils/tree/master/corradin_ovp_utils/datasets/genetic_file/Gen.py#L270" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_file_object_class</code>(<strong><code>prob_n_cols</code></strong>, <strong><code>rsid_col</code></strong>, <strong><code>alleleA_col</code></strong>, <strong><code>alleleB_col</code></strong>, <strong><code>load_args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h3 id="Test-functionalities-of-GenFileFormat">Test functionalities of <a href="/corradin_ovp_utils/datasets_genetic_dataset.html#GenFileFormat"><code>GenFileFormat</code></a><a class="anchor-link" href="#Test-functionalities-of-GenFileFormat"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conf_test_data_catalog</span><span class="p">[</span><span class="s2">&quot;genetic_file&quot;</span><span class="p">][</span><span class="s2">&quot;load_args&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;prob_n_cols&#39;: 3,
 &#39;initial_cols&#39;: [&#39;dashes&#39;, &#39;rsid&#39;, &#39;position&#39;, &#39;ref&#39;, &#39;alt&#39;],
 &#39;rsid_col&#39;: &#39;rsid&#39;,
 &#39;ref_col&#39;: &#39;ref&#39;,
 &#39;alt_col&#39;: &#39;alt&#39;,
 &#39;pandas_args&#39;: {&#39;sep&#39;: &#39; &#39;, &#39;header&#39;: None}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conf_test_data_catalog</span><span class="p">[</span><span class="s2">&quot;genetic_file&quot;</span><span class="p">][</span><span class="s2">&quot;file_path&quot;</span><span class="p">][</span><span class="s2">&quot;case&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;folder&#39;: &#39;data/test_data/gen_file&#39;,
 &#39;full_file_name&#39;: &#39;test_CASE_MS_chr22.gen&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_genetic_file_single_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">conf_test_data_catalog</span><span class="p">[</span><span class="s2">&quot;genetic_file_single&quot;</span><span class="p">][</span><span class="s2">&quot;file_path&quot;</span><span class="p">][</span><span class="s2">&quot;folder&quot;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">conf_test_data_catalog</span><span class="p">[</span><span class="s2">&quot;genetic_file_single&quot;</span><span class="p">][</span><span class="s2">&quot;file_path&quot;</span><span class="p">][</span><span class="s2">&quot;full_file_name&quot;</span><span class="p">])</span>
<span class="n">test_genetic_file_single_file_path</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;data/test_data/gen_file/test_CASE_MS_chr22.gen&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">schema_obj</span> <span class="o">=</span> <span class="n">SingleFilePathSchema</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">test_genetic_file_single_file_path</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                     <span class="n">full_file_name</span><span class="o">=</span><span class="n">test_genetic_file_single_file_path</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="n">schema_obj</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SingleFilePathSchema(folder=Path(&#39;data/test_data/gen_file&#39;), full_file_name=&#39;test_CASE_MS_chr22.gen&#39;, file_name=&#39;test_CASE_MS_chr22&#39;, extension=&#39;gen&#39;, split_by_chromosome=None)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_genfile_format</span> <span class="o">=</span> <span class="n">GenFileFormat</span><span class="p">(</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">schema_obj</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">conf_test_data_catalog</span><span class="p">[</span><span class="s2">&quot;genetic_file&quot;</span><span class="p">][</span><span class="s2">&quot;load_args&quot;</span><span class="p">])</span>
<span class="n">test_genfile_format</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GenFileFormat(file_path=SingleFilePathSchema(folder=Path(&#39;data/test_data/gen_file&#39;), full_file_name=&#39;test_CASE_MS_chr22.gen&#39;, file_name=&#39;test_CASE_MS_chr22&#39;, extension=&#39;gen&#39;, split_by_chromosome=None), prob_n_cols=3, initial_cols=[&#39;dashes&#39;, &#39;rsid&#39;, &#39;position&#39;, &#39;ref&#39;, &#39;alt&#39;], rsid_col=&#39;rsid&#39;, ref_col=&#39;ref&#39;, alt_col=&#39;alt&#39;, ref_alt_delim=None, pandas_args={&#39;sep&#39;: &#39; &#39;, &#39;header&#39;: None}, sample_ids=None, current_file_path=None)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_genfile_format</span><span class="o">.</span><span class="n">load</span><span class="p">()</span> <span class="c1">#genotypes()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dashes</th>
      <th>rsid</th>
      <th>position</th>
      <th>ref</th>
      <th>alt</th>
      <th>sample1_1</th>
      <th>sample1_2</th>
      <th>sample1_3</th>
      <th>sample2_1</th>
      <th>sample2_2</th>
      <th>...</th>
      <th>sample9769_3</th>
      <th>sample9770_1</th>
      <th>sample9770_2</th>
      <th>sample9770_3</th>
      <th>sample9771_1</th>
      <th>sample9771_2</th>
      <th>sample9771_3</th>
      <th>sample9772_1</th>
      <th>sample9772_2</th>
      <th>sample9772_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>---</td>
      <td>rs77948203</td>
      <td>21249165</td>
      <td>G</td>
      <td>A</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0.000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>---</td>
      <td>rs1014626</td>
      <td>21461017</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0.000</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>---</td>
      <td>rs9610458</td>
      <td>22205353</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0.000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>---</td>
      <td>rs5762201</td>
      <td>27888455</td>
      <td>A</td>
      <td>G</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0.012</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>---</td>
      <td>rs1004237</td>
      <td>28068501</td>
      <td>C</td>
      <td>T</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0.000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>---</td>
      <td>rs134490</td>
      <td>28730175</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0.232</td>
      <td>0.768</td>
      <td>0</td>
      <td>0.014</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.356</td>
      <td>0.644</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>---</td>
      <td>rs4821519</td>
      <td>37102100</td>
      <td>G</td>
      <td>C</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>1.000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>---</td>
      <td>rs1003500</td>
      <td>37262769</td>
      <td>C</td>
      <td>T</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0.000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>---</td>
      <td>rs5756405</td>
      <td>37310954</td>
      <td>A</td>
      <td>G</td>
      <td>0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0.000</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>9 rows × 29321 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_header</span> <span class="o">=</span> <span class="n">test_genfile_format</span><span class="o">.</span><span class="n">column_headers</span>
<span class="k">assert</span> <span class="n">test_header</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sample9772_3&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_genfile_format</span><span class="o">.</span><span class="n">get_rsid_df</span><span class="p">([</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs9610458&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;pandas.io.parsers.TextFileReader at 0x14abeb0bfc70&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">test_genfile_format</span><span class="o">.</span><span class="n">get_rsid_df</span><span class="p">([</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs9610458&quot;</span><span class="p">],</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dashes</th>
      <th>rsid</th>
      <th>position</th>
      <th>ref</th>
      <th>alt</th>
      <th>sample1_1</th>
      <th>sample1_2</th>
      <th>sample1_3</th>
      <th>sample2_1</th>
      <th>sample2_2</th>
      <th>...</th>
      <th>sample9769_3</th>
      <th>sample9770_1</th>
      <th>sample9770_2</th>
      <th>sample9770_3</th>
      <th>sample9771_1</th>
      <th>sample9771_2</th>
      <th>sample9771_3</th>
      <th>sample9772_1</th>
      <th>sample9772_2</th>
      <th>sample9772_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>---</td>
      <td>rs77948203</td>
      <td>21249165</td>
      <td>G</td>
      <td>A</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0.000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>---</td>
      <td>rs1014626</td>
      <td>21461017</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0.000</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>---</td>
      <td>rs9610458</td>
      <td>22205353</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0.000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>---</td>
      <td>rs5762201</td>
      <td>27888455</td>
      <td>A</td>
      <td>G</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0.012</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>---</td>
      <td>rs1004237</td>
      <td>28068501</td>
      <td>C</td>
      <td>T</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0.000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>---</td>
      <td>rs134490</td>
      <td>28730175</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0.232</td>
      <td>0.768</td>
      <td>0</td>
      <td>0.014</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.356</td>
      <td>0.644</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>---</td>
      <td>rs4821519</td>
      <td>37102100</td>
      <td>G</td>
      <td>C</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>1.000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>---</td>
      <td>rs1003500</td>
      <td>37262769</td>
      <td>C</td>
      <td>T</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0.000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>---</td>
      <td>rs5756405</td>
      <td>37310954</td>
      <td>A</td>
      <td>G</td>
      <td>0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>1</td>
      <td>0.000</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>9 rows × 29321 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_genfile_format</span><span class="o">.</span><span class="n">get_genotypes_df</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ref</th>
      <th>alt</th>
      <th>homo_ref</th>
      <th>het</th>
      <th>homo_alt</th>
    </tr>
    <tr>
      <th>rsid</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rs77948203</th>
      <td>G</td>
      <td>A</td>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs1014626</th>
      <td>C</td>
      <td>T</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs9610458</th>
      <td>C</td>
      <td>T</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs5762201</th>
      <td>A</td>
      <td>G</td>
      <td>AA</td>
      <td>AG</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>rs1004237</th>
      <td>C</td>
      <td>T</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs134490</th>
      <td>C</td>
      <td>T</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs4821519</th>
      <td>G</td>
      <td>C</td>
      <td>GG</td>
      <td>CG</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs1003500</th>
      <td>C</td>
      <td>T</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs5756405</th>
      <td>A</td>
      <td>G</td>
      <td>AA</td>
      <td>AG</td>
      <td>GG</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">test_genfile_format</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">==</span> <span class="mi">9772</span>
<span class="k">assert</span> <span class="n">test_genfile_format</span><span class="o">.</span><span class="n">gen_info_cols</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;rsid&#39;</span><span class="p">,</span> <span class="s1">&#39;ref&#39;</span><span class="p">,</span> <span class="s1">&#39;alt&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_sample</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">test_genfile_format</span><span class="o">.</span><span class="n">sample_columns_iter</span><span class="p">(</span><span class="n">rsid_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rs9610458&quot;</span><span class="p">,</span> <span class="s2">&quot;rs4821519&quot;</span><span class="p">]))</span>
<span class="n">first_sample</span><span class="o">.</span><span class="n">sample_df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_sample</span><span class="o">.</span><span class="n">sample_id</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">triplicate_converter</span><span class="p">(</span><span class="n">first_sample</span><span class="o">.</span><span class="n">sample_df</span><span class="p">,</span>
                     <span class="n">sample_id</span> <span class="o">=</span> <span class="n">first_sample</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span>
                    <span class="n">genotype_df</span> <span class="o">=</span> <span class="n">test_genfile_format</span><span class="o">.</span><span class="n">get_genotypes_df</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_genfile_format</span><span class="o">.</span><span class="n">get_genotypes_df</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_genfile_format</span><span class="o">.</span><span class="n">apply_func_to_all_samples</span><span class="p">(</span><span class="n">triplicate_converter</span><span class="p">,</span> 
                                              <span class="n">rsid_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rs9610458&quot;</span><span class="p">,</span> <span class="s2">&quot;rs4821519&quot;</span><span class="p">],</span>
                                              <span class="n">genotype_df</span> <span class="o">=</span> <span class="n">test_genfile_format</span><span class="o">.</span><span class="n">get_genotypes_df</span><span class="p">([</span><span class="s2">&quot;rs9610458&quot;</span><span class="p">,</span> <span class="s2">&quot;rs4821519&quot;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you don't input a list of rsids, it will use all the rsids in the dataset, which could take a <strong>LONG TIME</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_geno_each_sample</span> <span class="o">=</span> <span class="n">test_genfile_format</span><span class="o">.</span><span class="n">apply_func_to_all_samples</span><span class="p">(</span><span class="n">triplicate_converter</span><span class="p">,</span> 
                                              <span class="n">genotype_df</span> <span class="o">=</span> <span class="n">test_genfile_format</span><span class="o">.</span><span class="n">get_genotypes_df</span><span class="p">())</span><span class="o">.</span><span class="n">T</span> <span class="c1"># transposed</span>

<span class="n">test_geno_each_sample</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data_catalog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;geno_each_sample&quot;</span><span class="p">,</span> <span class="n">test_geno_each_sample</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_geno_each_sample</span><span class="p">[[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1004237&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1004237&quot;</span><span class="p">])[</span><span class="s2">&quot;sample_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="c1">#.melt(value_vars = [&quot;rs77948203&quot;, &quot;rs1014626&quot;], ignore_index=False).reset_index().groupby([&quot;rsid&quot;, &quot;value&quot;])[&quot;index&quot;].unique()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_geno_each_sample</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_genfile</span> <span class="o">=</span> <span class="n">test_genfile_format</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">test_genfile</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test-files-split-by-chromosomes">Test files split by chromosomes<a class="anchor-link" href="#Test-files-split-by-chromosomes"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_split_by_chrom</span> <span class="o">=</span> <span class="n">test_data_catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;genetic_file_split_by_chrom&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">test_split_by_chrom</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">29321</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">test_split_by_chrom</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">get_rsid_df</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">rsid_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">29321</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExceptionExpected</span><span class="p">(</span><span class="n">ex</span><span class="o">=</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="s2">&quot;Need to specify `chrom` argument&quot;</span><span class="p">):</span>
    <span class="n">test_split_by_chrom</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="k">with</span> <span class="n">ExceptionExpected</span><span class="p">(</span><span class="n">ex</span><span class="o">=</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="s2">&quot;Need to specify `chrom` argument&quot;</span><span class="p">):</span>
    <span class="n">test_split_by_chrom</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">get_rsid_df</span><span class="p">(</span><span class="n">rsid_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_split_by_chrom</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">get_genotypes_df</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_split_by_chrom</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">get_genotypes_df</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">rsid_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-big-input">Test big input<a class="anchor-link" href="#Test-big-input"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_catalog</span> <span class="o">=</span> <span class="n">get_catalog</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="s2">&quot;cluster&quot;</span><span class="p">)</span>
<span class="n">base_catalog</span> <span class="o">=</span> <span class="n">get_catalog</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:MainThread:anyconfig:Loading: /lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/conf/cluster/catalog_input/genetic_file.yaml
INFO:MainThread:anyconfig:Loading: /lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/conf/cluster/catalog_input/sample_file.yaml
INFO:MainThread:anyconfig:Loading: /lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/conf/base/catalog_input/genetic_file.yaml
INFO:MainThread:anyconfig:Loading: /lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/conf/base/catalog_input/query_rsids.yaml
INFO:MainThread:anyconfig:Loading: /lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/conf/base/catalog_input/sample_file.yaml
INFO:MainThread:anyconfig:Loading: /lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/conf/base/catalog_intermediate_output.yaml
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_genetic_file</span> <span class="o">=</span> <span class="n">big_catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;genetic_file_split_by_chrom&quot;</span><span class="p">)</span>
<span class="n">big_gen_file</span> <span class="o">=</span> <span class="n">GenFileFormat</span><span class="p">(</span><span class="o">**</span><span class="nb">vars</span><span class="p">(</span><span class="n">big_genetic_file</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">case</span><span class="p">))</span>
<span class="n">big_gen_file</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">chunksize</span><span class="o">=</span><span class="mi">1_000</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:MainThread:kedro.io.data_catalog:Loading data from `genetic_file_split_by_chrom` (OVPDataset)...
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;class &#39;__main__.create_file_object_class.&lt;locals&gt;.GenFileObject&#39;&gt;, chrom = 1, num_samples = 9772, file_path = &#39;/lab/corradin_dbgap/WTCCC2_all_controls_MS_UC/IMPUTE2_ALL/ALL_MS_impute2_chr1.gen&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">num_samples</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>9772.0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">_sample_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;sample9772&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">pandas_args</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;sep&#39;: &#39; &#39;, &#39;header&#39;: None}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">get_full_file_path</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/lab/corradin_dbgap/WTCCC2_all_controls_MS_UC/IMPUTE2_ALL/ALL_MS_impute2_chr22.gen&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-sample-query-rsid-list">Load sample query rsid list<a class="anchor-link" href="#Load-sample-query-rsid-list"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span> 
<span class="n">rsid_list</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">get_rsid_col</span><span class="p">(</span><span class="n">chrom</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rsid_list</span> <span class="o">=</span> <span class="n">rsid_list</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;rsid.str.startswith(&#39;r&#39;)&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 15min 4s, sys: 1min 1s, total: 16min 6s
Wall time: 17min 3s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">rsid_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2149254</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_snps_num</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">test_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fake_rsid&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">rsid_list</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">test_snps_num</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">rsid_list</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;rsid in @test_list&quot;</span><span class="p">)</span>
<span class="n">test_result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rsid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>rs145069787</td>
    </tr>
    <tr>
      <th>26</th>
      <td>rs12723953</td>
    </tr>
    <tr>
      <th>33</th>
      <td>rs76539137</td>
    </tr>
    <tr>
      <th>36</th>
      <td>rs72895585</td>
    </tr>
    <tr>
      <th>39</th>
      <td>rs183954195</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2154981</th>
      <td>rs67874053</td>
    </tr>
    <tr>
      <th>2154991</th>
      <td>rs12728804</td>
    </tr>
    <tr>
      <th>2155058</th>
      <td>rs145501305</td>
    </tr>
    <tr>
      <th>2155062</th>
      <td>rs270725</td>
    </tr>
    <tr>
      <th>2155094</th>
      <td>rs188420889</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_result</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;rsid == &#39;fake_rsid&#39;&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rsid</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base_catalog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;100k_rsids_only_chrom_1&quot;</span><span class="p">,</span> <span class="n">test_result</span><span class="p">)</span>
<span class="n">base_catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;100k_rsids_only_chrom_1&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:MainThread:kedro.io.data_catalog:Saving data to `100k_rsids_only_chrom_1` (CSVDataSet)...
INFO:MainThread:kedro.io.data_catalog:Loading data from `100k_rsids_only_chrom_1` (CSVDataSet)...
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rsid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>rs145069787</td>
    </tr>
    <tr>
      <th>26</th>
      <td>rs12723953</td>
    </tr>
    <tr>
      <th>33</th>
      <td>rs76539137</td>
    </tr>
    <tr>
      <th>36</th>
      <td>rs72895585</td>
    </tr>
    <tr>
      <th>39</th>
      <td>rs183954195</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2154981</th>
      <td>rs67874053</td>
    </tr>
    <tr>
      <th>2154991</th>
      <td>rs12728804</td>
    </tr>
    <tr>
      <th>2155058</th>
      <td>rs145501305</td>
    </tr>
    <tr>
      <th>2155062</th>
      <td>rs270725</td>
    </tr>
    <tr>
      <th>2155094</th>
      <td>rs188420889</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_result</span><span class="o">.</span><span class="n">rsid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>20         rs145069787
26          rs12723953
33          rs76539137
36          rs72895585
39         rs183954195
              ...     
2154981     rs67874053
2154991     rs12728804
2155058    rs145501305
2155062       rs270725
2155094    rs188420889
Name: rsid, Length: 100000, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">query_rsid_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">test_result</span><span class="o">.</span><span class="n">rsid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_gen_file_chrom_1</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">chunksize</span><span class="o">=</span><span class="mi">1_000</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span><span class="p">)</span>
<span class="n">test_gen_file_chrom_1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;class &#39;__main__.create_file_object_class.&lt;locals&gt;.GenFileObject&#39;&gt;, chrom = 1, num_samples = 9772, file_path = &#39;/lab/corradin_dbgap/WTCCC2_all_controls_MS_UC/IMPUTE2_ALL/ALL_MS_impute2_chr1.gen&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> geno_each_sample_100k_SNPs = test_gen_file_chrom_1.get_rsid_df(query_rsid_set, [&quot;rsid&quot;, &quot;position&quot;], batch_size = 100_000)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>reading genetic file and collecting found SNPs
processing batch
processing last batch
CPU times: user 1h 3min 33s, sys: 8min 18s, total: 1h 11min 51s
Wall time: 1h 11min 40s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> test_gen_file_chrom_1.get_rsid_df(query_rsid_set, [&quot;rsid&quot;, &quot;position&quot;], batch_size = 1_000)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>reading genetic file and collecting found SNPs
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing batch
processing last batch
CPU times: user 2h 17min 41s, sys: 10min 18s, total: 2h 28min
Wall time: 2h 26min 59s
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>id_col</th>
      <th>rs145069787</th>
      <th>rs12723953</th>
      <th>rs76539137</th>
      <th>rs72895585</th>
      <th>rs183954195</th>
      <th>rs185007189</th>
      <th>rs7556636</th>
      <th>rs145966388</th>
      <th>rs79421110</th>
      <th>rs74070515</th>
      <th>...</th>
      <th>rs1812336</th>
      <th>rs12747060</th>
      <th>rs115621001</th>
      <th>rs72895568</th>
      <th>rs2994537</th>
      <th>rs67874053</th>
      <th>rs12728804</th>
      <th>rs145501305</th>
      <th>rs270725</th>
      <th>rs188420889</th>
    </tr>
    <tr>
      <th>sample_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sample1</th>
      <td>GG</td>
      <td>TT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>AA</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample2</th>
      <td>GG</td>
      <td>CT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>AG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>AG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample3</th>
      <td>GG</td>
      <td>NA</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>NA</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample4</th>
      <td>GG</td>
      <td>NA</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>GT</td>
      <td>AG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>AG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample5</th>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>sample9768</th>
      <td>GG</td>
      <td>CT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>AG</td>
      <td>CC</td>
      <td>...</td>
      <td>GT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample9769</th>
      <td>GG</td>
      <td>CT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CT</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample9770</th>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample9771</th>
      <td>GG</td>
      <td>CT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CT</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample9772</th>
      <td>GG</td>
      <td>CT</td>
      <td>AC</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>...</td>
      <td>GT</td>
      <td>AG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AT</td>
      <td>CT</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
  </tbody>
</table>
<p>9772 rows × 100000 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">column_headers</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;rsid&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">found_line</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">test_generator</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">file</span><span class="p">)):</span>
        <span class="n">line_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">query_rsid_set</span><span class="p">:</span>
            <span class="n">found_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line_list</span><span class="p">)</span>
        
        
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> combined_lines = pd.DataFrame.from_records(found_line, columns = big_gen_file.column_headers)
<span class="n">combined_lines</span> <span class="o">=</span> <span class="n">combined_lines</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;rsid&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 19min 4s, sys: 59.3 s, total: 20min 3s
Wall time: 20min 3s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> combined_lines.set_index(&quot;rsid&quot;)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 47.3 s, sys: 34 s, total: 1min 21s
Wall time: 1min 20s
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dashes</th>
      <th>position</th>
      <th>ref</th>
      <th>alt</th>
      <th>sample1_1</th>
      <th>sample1_2</th>
      <th>sample1_3</th>
      <th>sample2_1</th>
      <th>sample2_2</th>
      <th>sample2_3</th>
      <th>...</th>
      <th>sample9770_3</th>
      <th>sample9771_1</th>
      <th>sample9771_2</th>
      <th>sample9771_3</th>
      <th>sample9772_1</th>
      <th>sample9772_2</th>
      <th>sample9772_3</th>
      <th>homo_ref</th>
      <th>het</th>
      <th>homo_alt</th>
    </tr>
    <tr>
      <th>rsid</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rs145069787</th>
      <td>---</td>
      <td>45001018</td>
      <td>G</td>
      <td>A</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs12723953</th>
      <td>---</td>
      <td>45001453</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.052</td>
      <td>0.948</td>
      <td>0</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs76539137</th>
      <td>---</td>
      <td>45002271</td>
      <td>A</td>
      <td>C</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.002</td>
      <td>0.924</td>
      <td>0.075</td>
      <td>AA</td>
      <td>AC</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs72895585</th>
      <td>---</td>
      <td>45002766</td>
      <td>C</td>
      <td>T</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs183954195</th>
      <td>---</td>
      <td>45003250</td>
      <td>T</td>
      <td>A</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>TT</td>
      <td>AT</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>rs67874053</th>
      <td>---</td>
      <td>44984011</td>
      <td>C</td>
      <td>T</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs12728804</th>
      <td>---</td>
      <td>44984921</td>
      <td>G</td>
      <td>A</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs145501305</th>
      <td>---</td>
      <td>44991420</td>
      <td>T</td>
      <td>A</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>TT</td>
      <td>AT</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs270725</th>
      <td>---</td>
      <td>44991725</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs188420889</th>
      <td>---</td>
      <td>44994256</td>
      <td>G</td>
      <td>A</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 29323 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> corradin_ovp_utils.datasets.genetic_file.get_possible_geno_combinations(combined_lines.set_index(&quot;rsid&quot;), big_gen_file.ref_col, big_gen_file.alt_col)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 9s, sys: 40 s, total: 1min 49s
Wall time: 1min 48s
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>homo_ref</th>
      <th>het</th>
      <th>homo_alt</th>
    </tr>
    <tr>
      <th>rsid</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rs145069787</th>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs12723953</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs76539137</th>
      <td>AA</td>
      <td>AC</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs72895585</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs183954195</th>
      <td>TT</td>
      <td>AT</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>rs67874053</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs12728804</th>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs145501305</th>
      <td>TT</td>
      <td>AT</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs270725</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs188420889</th>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> geno_df = corradin_ovp_utils.datasets.genetic_file.get_possible_geno_combinations(combined_lines.set_index(&quot;rsid&quot;), big_gen_file.ref_col, big_gen_file.alt_col)
<span class="n">geno_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 11s, sys: 41.9 s, total: 1min 53s
Wall time: 1min 51s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geno_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>homo_ref</th>
      <th>het</th>
      <th>homo_alt</th>
    </tr>
    <tr>
      <th>rsid</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rs145069787</th>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs12723953</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs76539137</th>
      <td>AA</td>
      <td>AC</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs72895585</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs183954195</th>
      <td>TT</td>
      <td>AT</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>rs67874053</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs12728804</th>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs145501305</th>
      <td>TT</td>
      <td>AT</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs270725</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs188420889</th>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">sample_cols</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_func</span><span class="p">(</span><span class="n">rsid_df</span><span class="p">):</span> 
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">_sample_list</span><span class="p">:</span>
        <span class="n">sample_cols</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">allele_prob_col_num</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">allele_prob_col_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">prob_n_cols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">sample_cols_df</span> <span class="o">=</span> <span class="n">rsid_df</span><span class="p">[</span><span class="n">sample_cols</span><span class="p">]</span>
        <span class="k">yield</span> <span class="n">SimpleNamespace</span><span class="p">(</span><span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample</span><span class="p">,</span>
                              <span class="n">sample_df</span> <span class="o">=</span> <span class="n">sample_cols_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_func</span><span class="p">(</span><span class="n">combined_lines</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">triplicate_converter</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="p">,</span> <span class="n">genotype_df</span><span class="o">=</span> <span class="n">geno_df</span><span class="p">,</span> <span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample_id</span><span class="p">))</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>            sample1_1 sample1_2 sample1_3
rsid                                     
rs145069787         1         0         0
rs12723953          0         0         1
rs76539137          1         0         0
rs72895585          1         0         0
rs183954195         1         0         0
...               ...       ...       ...
rs67874053          1         0         0
rs12728804          0         0         1
rs145501305         1         0         0
rs270725            0         0         1
rs188420889         1         0         0

[100000 rows x 3 columns]
sample_id   sample1
rsid               
rs145069787      GG
rs12723953       TT
rs76539137       AA
rs72895585       CC
rs183954195      TT
...             ...
rs67874053       CC
rs12728804       AA
rs145501305      TT
rs270725         TT
rs188420889      GG

[100000 rows x 1 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_samples_df</span> <span class="o">=</span> <span class="p">[</span><span class="n">triplicate_converter</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="p">,</span> <span class="n">genotype_df</span><span class="o">=</span> <span class="n">geno_df</span><span class="p">,</span> <span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_func</span><span class="p">(</span><span class="n">combined_lines</span><span class="p">))]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> all_samples_df_final = pd.concat(all_samples_df, axis=1)
<span class="n">all_samples_df_final</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 3s, sys: 6.15 s, total: 1min 10s
Wall time: 1min 10s
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>sample_id</th>
      <th>sample1</th>
      <th>sample2</th>
      <th>sample3</th>
      <th>sample4</th>
      <th>sample5</th>
      <th>sample6</th>
      <th>sample7</th>
      <th>sample8</th>
      <th>sample9</th>
      <th>sample10</th>
      <th>...</th>
      <th>sample9763</th>
      <th>sample9764</th>
      <th>sample9765</th>
      <th>sample9766</th>
      <th>sample9767</th>
      <th>sample9768</th>
      <th>sample9769</th>
      <th>sample9770</th>
      <th>sample9771</th>
      <th>sample9772</th>
    </tr>
    <tr>
      <th>rsid</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rs145069787</th>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>...</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>rs12723953</th>
      <td>TT</td>
      <td>CT</td>
      <td>NA</td>
      <td>NA</td>
      <td>CC</td>
      <td>CT</td>
      <td>NA</td>
      <td>TT</td>
      <td>NA</td>
      <td>CT</td>
      <td>...</td>
      <td>CT</td>
      <td>TT</td>
      <td>CT</td>
      <td>CC</td>
      <td>CT</td>
      <td>CT</td>
      <td>CT</td>
      <td>CC</td>
      <td>CT</td>
      <td>CT</td>
    </tr>
    <tr>
      <th>rs76539137</th>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>...</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AA</td>
      <td>AC</td>
    </tr>
    <tr>
      <th>rs72895585</th>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>...</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs183954195</th>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>...</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>rs67874053</th>
      <td>CC</td>
      <td>CC</td>
      <td>NA</td>
      <td>CC</td>
      <td>CC</td>
      <td>CT</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>...</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CC</td>
      <td>CT</td>
    </tr>
    <tr>
      <th>rs12728804</th>
      <td>AA</td>
      <td>AG</td>
      <td>NA</td>
      <td>AG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>AG</td>
      <td>GG</td>
      <td>GG</td>
      <td>...</td>
      <td>GG</td>
      <td>AG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>rs145501305</th>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>...</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs270725</th>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>...</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs188420889</th>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>...</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
      <td>GG</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 9772 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> all_samples_df_final_transposed = all_samples_df_final.T
<span class="n">all_samples_df_final_transposed</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 2min 24s, sys: 41.3 s, total: 3min 5s
Wall time: 3min 5s
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>rsid</th>
      <th>rs145069787</th>
      <th>rs12723953</th>
      <th>rs76539137</th>
      <th>rs72895585</th>
      <th>rs183954195</th>
      <th>rs185007189</th>
      <th>rs7556636</th>
      <th>rs145966388</th>
      <th>rs79421110</th>
      <th>rs74070515</th>
      <th>...</th>
      <th>rs1812336</th>
      <th>rs12747060</th>
      <th>rs115621001</th>
      <th>rs72895568</th>
      <th>rs2994537</th>
      <th>rs67874053</th>
      <th>rs12728804</th>
      <th>rs145501305</th>
      <th>rs270725</th>
      <th>rs188420889</th>
    </tr>
    <tr>
      <th>sample_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sample1</th>
      <td>GG</td>
      <td>TT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>AA</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample2</th>
      <td>GG</td>
      <td>CT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>AG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>AG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample3</th>
      <td>GG</td>
      <td>NA</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>NA</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample4</th>
      <td>GG</td>
      <td>NA</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>GT</td>
      <td>AG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>AG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample5</th>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>sample9768</th>
      <td>GG</td>
      <td>CT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>AG</td>
      <td>CC</td>
      <td>...</td>
      <td>GT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample9769</th>
      <td>GG</td>
      <td>CT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CT</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample9770</th>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample9771</th>
      <td>GG</td>
      <td>CT</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CT</td>
      <td>...</td>
      <td>TT</td>
      <td>GG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>sample9772</th>
      <td>GG</td>
      <td>CT</td>
      <td>AC</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>AA</td>
      <td>CC</td>
      <td>...</td>
      <td>GT</td>
      <td>AG</td>
      <td>GG</td>
      <td>AA</td>
      <td>AT</td>
      <td>CT</td>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
    </tr>
  </tbody>
</table>
<p>9772 rows × 100000 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">combined_lines</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>170551438050</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">found_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">query_rsid_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">test_result</span><span class="o">.</span><span class="n">rsid</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_generator</span><span class="o">.</span><span class="n">df</span><span class="p">):</span>
    <span class="n">found_rsids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">&amp;</span> <span class="n">query_rsid_set</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">found_rsids</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">found_rsids</span><span class="p">]</span>
        <span class="n">found_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;found </span><span class="si">{</span><span class="n">filtered_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>found 54
found 55
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ParserError</span>                               Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-111-9011243eb578&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> found_dfs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> query_rsid_set <span class="ansi-blue-fg">=</span> set<span class="ansi-blue-fg">(</span>test_result<span class="ansi-blue-fg">.</span>rsid<span class="ansi-blue-fg">.</span>tolist<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">for</span> df <span class="ansi-green-fg">in</span> tqdm<span class="ansi-blue-fg">(</span>test_generator<span class="ansi-blue-fg">.</span>df<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     found_rsids <span class="ansi-blue-fg">=</span> set<span class="ansi-blue-fg">(</span>df<span class="ansi-blue-fg">.</span>index<span class="ansi-blue-fg">.</span>tolist<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> query_rsid_set
<span class="ansi-green-intense-fg ansi-bold">      5</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> found_rsids<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/tqdm/notebook.py</span> in <span class="ansi-cyan-fg">__iter__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    251</span>     <span class="ansi-green-fg">def</span> __iter__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    252</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 253</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">for</span> obj <span class="ansi-green-fg">in</span> super<span class="ansi-blue-fg">(</span>tqdm_notebook<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__iter__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    254</span>                 <span class="ansi-red-fg"># return super(tqdm...) will not catch exception</span>
<span class="ansi-green-intense-fg ansi-bold">    255</span>                 <span class="ansi-green-fg">yield</span> obj

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/tqdm/std.py</span> in <span class="ansi-cyan-fg">__iter__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1174</span> 
<span class="ansi-green-intense-fg ansi-bold">   1175</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1176</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">for</span> obj <span class="ansi-green-fg">in</span> iterable<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1177</span>                 <span class="ansi-green-fg">yield</span> obj
<span class="ansi-green-intense-fg ansi-bold">   1178</span>                 <span class="ansi-red-fg"># Update and possibly print the progressbar.</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">__next__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1032</span>     <span class="ansi-green-fg">def</span> __next__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1033</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1034</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>get_chunk<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1035</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1036</span>             self<span class="ansi-blue-fg">.</span>close<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">get_chunk</span><span class="ansi-blue-fg">(self, size)</span>
<span class="ansi-green-intense-fg ansi-bold">   1082</span>                 <span class="ansi-green-fg">raise</span> StopIteration
<span class="ansi-green-intense-fg ansi-bold">   1083</span>             size <span class="ansi-blue-fg">=</span> min<span class="ansi-blue-fg">(</span>size<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>nrows <span class="ansi-blue-fg">-</span> self<span class="ansi-blue-fg">.</span>_currow<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1084</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">=</span>size<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1085</span> 
<span class="ansi-green-intense-fg ansi-bold">   1086</span>     <span class="ansi-green-fg">def</span> __enter__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   1055</span>     <span class="ansi-green-fg">def</span> read<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1056</span>         nrows <span class="ansi-blue-fg">=</span> validate_integer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;nrows&#34;</span><span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1057</span><span class="ansi-red-fg">         </span>index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">,</span> col_dict <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_engine<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1058</span> 
<span class="ansi-green-intense-fg ansi-bold">   1059</span>         <span class="ansi-green-fg">if</span> index <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   2059</span>     <span class="ansi-green-fg">def</span> read<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2060</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2061</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_reader<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2062</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2063</span>             <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_first_chunk<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader.read</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._read_low_memory</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._read_rows</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._tokenize_rows</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.raise_parser_error</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">ParserError</span>: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine=&#39;python&#39;.</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">_sample_list</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-57-16d8f9f5c9d6&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>big_gen_file<span class="ansi-blue-fg">.</span>_sample_list

<span class="ansi-green-fg">&lt;ipython-input-55-30e06bd06d53&gt;</span> in <span class="ansi-cyan-fg">_sample_list</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     52</span>             <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>sample_ids
<span class="ansi-green-intense-fg ansi-bold">     53</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 54</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> list<span class="ansi-blue-fg">(</span>set<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>col<span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;_&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> col <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>sample_cols<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     55</span> 
<span class="ansi-green-intense-fg ansi-bold">     56</span>     <span class="ansi-blue-fg">@</span>property

<span class="ansi-green-fg">&lt;ipython-input-55-30e06bd06d53&gt;</span> in <span class="ansi-cyan-fg">sample_cols</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>     <span class="ansi-blue-fg">@</span>property
<span class="ansi-green-intense-fg ansi-bold">     45</span>     <span class="ansi-green-fg">def</span> sample_cols<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 46</span><span class="ansi-red-fg">         </span>cols <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>col <span class="ansi-green-fg">for</span> col <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>column_headers <span class="ansi-green-fg">if</span> col <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">in</span> set<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>initial_cols<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     47</span>         <span class="ansi-green-fg">return</span> cols
<span class="ansi-green-intense-fg ansi-bold">     48</span> 

<span class="ansi-green-fg">&lt;ipython-input-55-30e06bd06d53&gt;</span> in <span class="ansi-cyan-fg">column_headers</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span>     <span class="ansi-green-fg">def</span> column_headers<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     39</span>         <span class="ansi-red-fg">#read the first non-header line</span>
<span class="ansi-green-fg">---&gt; 40</span><span class="ansi-red-fg">         </span>first_line_df <span class="ansi-blue-fg">=</span> next<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_load_unprocessed<span class="ansi-blue-fg">(</span>chunksize<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     41</span>         generator <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>col_name_generator<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     42</span>         <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>next<span class="ansi-blue-fg">(</span>generator<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> col <span class="ansi-green-fg">in</span> first_line_df<span class="ansi-blue-fg">.</span>columns<span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">&lt;ipython-input-55-30e06bd06d53&gt;</span> in <span class="ansi-cyan-fg">_load_unprocessed</span><span class="ansi-blue-fg">(self, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     67</span>     <span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>pd<span class="ansi-blue-fg">.</span>read_csv<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     68</span>     <span class="ansi-green-fg">def</span> _load_unprocessed<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 69</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> pd<span class="ansi-blue-fg">.</span>read_csv<span class="ansi-blue-fg">(</span>filepath_or_buffer <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>current_file_path<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>self<span class="ansi-blue-fg">.</span>pandas_args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     70</span> 
<span class="ansi-green-intense-fg ansi-bold">     71</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read_csv</span><span class="ansi-blue-fg">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, dialect, error_bad_lines, warn_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="ansi-green-intense-fg ansi-bold">    608</span>     kwds<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>kwds_defaults<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    609</span> 
<span class="ansi-green-fg">--&gt; 610</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> _read<span class="ansi-blue-fg">(</span>filepath_or_buffer<span class="ansi-blue-fg">,</span> kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    611</span> 
<span class="ansi-green-intense-fg ansi-bold">    612</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">_read</span><span class="ansi-blue-fg">(filepath_or_buffer, kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    460</span> 
<span class="ansi-green-intense-fg ansi-bold">    461</span>     <span class="ansi-red-fg"># Create the parser.</span>
<span class="ansi-green-fg">--&gt; 462</span><span class="ansi-red-fg">     </span>parser <span class="ansi-blue-fg">=</span> TextFileReader<span class="ansi-blue-fg">(</span>filepath_or_buffer<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    463</span> 
<span class="ansi-green-intense-fg ansi-bold">    464</span>     <span class="ansi-green-fg">if</span> chunksize <span class="ansi-green-fg">or</span> iterator<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, f, engine, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    817</span>             self<span class="ansi-blue-fg">.</span>options<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;has_index_names&#34;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> kwds<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;has_index_names&#34;</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    818</span> 
<span class="ansi-green-fg">--&gt; 819</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_engine <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_make_engine<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>engine<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    820</span> 
<span class="ansi-green-intense-fg ansi-bold">    821</span>     <span class="ansi-green-fg">def</span> close<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">_make_engine</span><span class="ansi-blue-fg">(self, engine)</span>
<span class="ansi-green-intense-fg ansi-bold">   1048</span>             )
<span class="ansi-green-intense-fg ansi-bold">   1049</span>         <span class="ansi-red-fg"># error: Too many arguments for &#34;ParserBase&#34;</span>
<span class="ansi-green-fg">-&gt; 1050</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> mapping<span class="ansi-blue-fg">[</span>engine<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>self<span class="ansi-blue-fg">.</span>options<span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># type: ignore[call-arg]</span>
<span class="ansi-green-intense-fg ansi-bold">   1051</span> 
<span class="ansi-green-intense-fg ansi-bold">   1052</span>     <span class="ansi-green-fg">def</span> _failover_to_python<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, src, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">   1865</span> 
<span class="ansi-green-intense-fg ansi-bold">   1866</span>         <span class="ansi-red-fg"># open handles</span>
<span class="ansi-green-fg">-&gt; 1867</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_open_handles<span class="ansi-blue-fg">(</span>src<span class="ansi-blue-fg">,</span> kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1868</span>         <span class="ansi-green-fg">assert</span> self<span class="ansi-blue-fg">.</span>handles <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-intense-fg ansi-bold">   1869</span>         <span class="ansi-green-fg">for</span> key <span class="ansi-green-fg">in</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;storage_options&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;encoding&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;memory_map&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;compression&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">_open_handles</span><span class="ansi-blue-fg">(self, src, kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">   1360</span>         Let the readers open IOHanldes after they are done <span class="ansi-green-fg">with</span> their potential raises<span class="ansi-blue-fg">.</span>
<span class="ansi-green-intense-fg ansi-bold">   1361</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">-&gt; 1362</span><span class="ansi-red-fg">         self.handles = get_handle(
</span><span class="ansi-green-intense-fg ansi-bold">   1363</span>             src<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1364</span>             <span class="ansi-blue-fg">&#34;r&#34;</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/common.py</span> in <span class="ansi-cyan-fg">get_handle</span><span class="ansi-blue-fg">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="ansi-green-intense-fg ansi-bold">    556</span> 
<span class="ansi-green-intense-fg ansi-bold">    557</span>     <span class="ansi-red-fg"># open URLs</span>
<span class="ansi-green-fg">--&gt; 558</span><span class="ansi-red-fg">     ioargs = _get_filepath_or_buffer(
</span><span class="ansi-green-intense-fg ansi-bold">    559</span>         path_or_buf<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    560</span>         encoding<span class="ansi-blue-fg">=</span>encoding<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/common.py</span> in <span class="ansi-cyan-fg">_get_filepath_or_buffer</span><span class="ansi-blue-fg">(filepath_or_buffer, encoding, compression, mode, storage_options)</span>
<span class="ansi-green-intense-fg ansi-bold">    369</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> is_file_like<span class="ansi-blue-fg">(</span>filepath_or_buffer<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    370</span>         msg <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">f&#34;Invalid file path or buffer object type: {type(filepath_or_buffer)}&#34;</span>
<span class="ansi-green-fg">--&gt; 371</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span>msg<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    372</span> 
<span class="ansi-green-intense-fg ansi-bold">    373</span>     return IOArgs(

<span class="ansi-red-fg">ValueError</span>: Invalid file path or buffer object type: &lt;class &#39;NoneType&#39;&gt;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_func</span><span class="p">(</span><span class="n">rsid_df</span><span class="p">):</span> 
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">_sample_list</span><span class="p">:</span>
        <span class="n">sample_cols</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">allele_prob_col_num</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">allele_prob_col_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">prob_n_cols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">sample_cols_df</span> <span class="o">=</span> <span class="n">rsid_df</span><span class="p">[</span><span class="n">sample_cols</span><span class="p">]</span>
        <span class="k">yield</span> <span class="n">SimpleNamespace</span><span class="p">(</span><span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample</span><span class="p">,</span>
                              <span class="n">sample_df</span> <span class="o">=</span> <span class="n">sample_cols_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geno_df</span> <span class="o">=</span> <span class="n">corradin_ovp_utils</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">genetic_file</span><span class="o">.</span><span class="n">get_possible_geno_combinations</span><span class="p">(</span><span class="n">test_double_checked</span><span class="p">,</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">ref_col</span><span class="p">,</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">alt_col</span><span class="p">)</span>
<span class="n">geno_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>homo_ref</th>
      <th>het</th>
      <th>homo_alt</th>
    </tr>
    <tr>
      <th>rsid</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rs145069787</th>
      <td>GG</td>
      <td>AG</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs12723953</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs76539137</th>
      <td>AA</td>
      <td>AC</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs72895585</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
    <tr>
      <th>rs183954195</th>
      <td>TT</td>
      <td>AT</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>rs150084180</th>
      <td>TT</td>
      <td>AT</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>rs72671670</th>
      <td>TT</td>
      <td>CT</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs144804148</th>
      <td>TT</td>
      <td>CT</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs78101999</th>
      <td>TT</td>
      <td>CT</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>rs79916150</th>
      <td>CC</td>
      <td>CT</td>
      <td>TT</td>
    </tr>
  </tbody>
</table>
<p>9482 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample1_1</th>
      <th>sample1_2</th>
      <th>sample1_3</th>
    </tr>
    <tr>
      <th>rsid</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rs182679417</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>rs141600902</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>rs200576390</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>rs145969444</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>rs184502689</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>rs117795588</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>rs143237683</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>rs141475345</th>
      <td>0.264</td>
      <td>0.736</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>rs12139639</th>
      <td>0.000</td>
      <td>0.107</td>
      <td>0.892</td>
    </tr>
    <tr>
      <th>rs1935557</th>
      <td>0.007</td>
      <td>0.992</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
<p>9732 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>rs150703402    1
rs184623073    1
rs138555012    1
rs139881166    1
rs150639980    1
              ..
rs115567803    1
rs199790570    1
rs184863209    1
rs190308550    1
rs12130529     1
Name: rsid, Length: 9732, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">geno_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>435</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">test_result</span><span class="o">.</span><span class="n">rsid</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>set()</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">test_result</span><span class="o">.</span><span class="n">rsid</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>190268</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">test_generator</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">chrom</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rsid_list</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="n">found_rsid_set</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span><span class="p">)</span>
<span class="n">all_SNPs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_generator</span><span class="p">):</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;index in @test_result.rsid.unique()&quot;</span><span class="p">)</span>
    <span class="n">geno_df</span> <span class="o">=</span> <span class="n">corradin_ovp_utils</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">genetic_file</span><span class="o">.</span><span class="n">get_possible_geno_combinations</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">ref_col</span><span class="p">,</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">alt_col</span><span class="p">)</span>
    <span class="n">all_samples_one_SNP_partition_dfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">triplicate_converter</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="p">,</span> <span class="n">genotype_df</span><span class="o">=</span> <span class="n">geno_df</span><span class="p">,</span> <span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample_id</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_func</span><span class="p">(</span><span class="n">test</span><span class="p">))]</span>
    <span class="n">all_SNPs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_samples_one_SNP_partition_dfs</span><span class="p">))</span>
    
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">MemoryError</span>                               Traceback (most recent call last)
<span class="ansi-green-fg">&lt;timed exec&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/tqdm/notebook.py</span> in <span class="ansi-cyan-fg">__iter__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    251</span>     <span class="ansi-green-fg">def</span> __iter__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    252</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 253</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">for</span> obj <span class="ansi-green-fg">in</span> super<span class="ansi-blue-fg">(</span>tqdm_notebook<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__iter__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    254</span>                 <span class="ansi-red-fg"># return super(tqdm...) will not catch exception</span>
<span class="ansi-green-intense-fg ansi-bold">    255</span>                 <span class="ansi-green-fg">yield</span> obj

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/tqdm/std.py</span> in <span class="ansi-cyan-fg">__iter__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1174</span> 
<span class="ansi-green-intense-fg ansi-bold">   1175</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1176</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">for</span> obj <span class="ansi-green-fg">in</span> iterable<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1177</span>                 <span class="ansi-green-fg">yield</span> obj
<span class="ansi-green-intense-fg ansi-bold">   1178</span>                 <span class="ansi-red-fg"># Update and possibly print the progressbar.</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">__next__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1032</span>     <span class="ansi-green-fg">def</span> __next__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1033</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1034</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>get_chunk<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1035</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1036</span>             self<span class="ansi-blue-fg">.</span>close<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">get_chunk</span><span class="ansi-blue-fg">(self, size)</span>
<span class="ansi-green-intense-fg ansi-bold">   1082</span>                 <span class="ansi-green-fg">raise</span> StopIteration
<span class="ansi-green-intense-fg ansi-bold">   1083</span>             size <span class="ansi-blue-fg">=</span> min<span class="ansi-blue-fg">(</span>size<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>nrows <span class="ansi-blue-fg">-</span> self<span class="ansi-blue-fg">.</span>_currow<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1084</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">=</span>size<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1085</span> 
<span class="ansi-green-intense-fg ansi-bold">   1086</span>     <span class="ansi-green-fg">def</span> __enter__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   1067</span>             new_rows <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>index<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1068</span> 
<span class="ansi-green-fg">-&gt; 1069</span><span class="ansi-red-fg">         </span>df <span class="ansi-blue-fg">=</span> DataFrame<span class="ansi-blue-fg">(</span>col_dict<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">=</span>columns<span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">=</span>index<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1070</span> 
<span class="ansi-green-intense-fg ansi-bold">   1071</span>         self<span class="ansi-blue-fg">.</span>_currow <span class="ansi-blue-fg">+=</span> new_rows

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/frame.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, data, index, columns, dtype, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    527</span> 
<span class="ansi-green-intense-fg ansi-bold">    528</span>         <span class="ansi-green-fg">elif</span> isinstance<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> dict<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 529</span><span class="ansi-red-fg">             </span>mgr <span class="ansi-blue-fg">=</span> init_dict<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    530</span>         <span class="ansi-green-fg">elif</span> isinstance<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> ma<span class="ansi-blue-fg">.</span>MaskedArray<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    531</span>             <span class="ansi-green-fg">import</span> numpy<span class="ansi-blue-fg">.</span>ma<span class="ansi-blue-fg">.</span>mrecords <span class="ansi-green-fg">as</span> mrecords

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/construction.py</span> in <span class="ansi-cyan-fg">init_dict</span><span class="ansi-blue-fg">(data, index, columns, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">    285</span>             arr <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> is_datetime64tz_dtype<span class="ansi-blue-fg">(</span>arr<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> arr<span class="ansi-blue-fg">.</span>copy<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> arr <span class="ansi-green-fg">in</span> arrays
<span class="ansi-green-intense-fg ansi-bold">    286</span>         ]
<span class="ansi-green-fg">--&gt; 287</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> arrays_to_mgr<span class="ansi-blue-fg">(</span>arrays<span class="ansi-blue-fg">,</span> data_names<span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    288</span> 
<span class="ansi-green-intense-fg ansi-bold">    289</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/construction.py</span> in <span class="ansi-cyan-fg">arrays_to_mgr</span><span class="ansi-blue-fg">(arrays, arr_names, index, columns, dtype, verify_integrity)</span>
<span class="ansi-green-intense-fg ansi-bold">     93</span>     axes <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>columns<span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     94</span> 
<span class="ansi-green-fg">---&gt; 95</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> create_block_manager_from_arrays<span class="ansi-blue-fg">(</span>arrays<span class="ansi-blue-fg">,</span> arr_names<span class="ansi-blue-fg">,</span> axes<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     96</span> 
<span class="ansi-green-intense-fg ansi-bold">     97</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/managers.py</span> in <span class="ansi-cyan-fg">create_block_manager_from_arrays</span><span class="ansi-blue-fg">(arrays, names, axes)</span>
<span class="ansi-green-intense-fg ansi-bold">   1699</span>     arrays <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>x <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> ABCPandasArray<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> x<span class="ansi-blue-fg">.</span>to_numpy<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> arrays<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1700</span>     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1701</span><span class="ansi-red-fg">         </span>blocks <span class="ansi-blue-fg">=</span> _form_blocks<span class="ansi-blue-fg">(</span>arrays<span class="ansi-blue-fg">,</span> names<span class="ansi-blue-fg">,</span> axes<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1702</span>         mgr <span class="ansi-blue-fg">=</span> BlockManager<span class="ansi-blue-fg">(</span>blocks<span class="ansi-blue-fg">,</span> axes<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1703</span>         mgr<span class="ansi-blue-fg">.</span>_consolidate_inplace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/managers.py</span> in <span class="ansi-cyan-fg">_form_blocks</span><span class="ansi-blue-fg">(arrays, names, axes)</span>
<span class="ansi-green-intense-fg ansi-bold">   1757</span>     blocks<span class="ansi-blue-fg">:</span> List<span class="ansi-blue-fg">[</span>Block<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1758</span>     <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>items_dict<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;FloatBlock&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1759</span><span class="ansi-red-fg">         </span>float_blocks <span class="ansi-blue-fg">=</span> _multi_blockify<span class="ansi-blue-fg">(</span>items_dict<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;FloatBlock&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1760</span>         blocks<span class="ansi-blue-fg">.</span>extend<span class="ansi-blue-fg">(</span>float_blocks<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1761</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/managers.py</span> in <span class="ansi-cyan-fg">_multi_blockify</span><span class="ansi-blue-fg">(tuples, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">   1850</span>     <span class="ansi-green-fg">for</span> dtype<span class="ansi-blue-fg">,</span> tup_block <span class="ansi-green-fg">in</span> grouper<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1851</span> 
<span class="ansi-green-fg">-&gt; 1852</span><span class="ansi-red-fg">         </span>values<span class="ansi-blue-fg">,</span> placement <span class="ansi-blue-fg">=</span> _stack_arrays<span class="ansi-blue-fg">(</span>list<span class="ansi-blue-fg">(</span>tup_block<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1853</span> 
<span class="ansi-green-intense-fg ansi-bold">   1854</span>         block <span class="ansi-blue-fg">=</span> make_block<span class="ansi-blue-fg">(</span>values<span class="ansi-blue-fg">,</span> placement<span class="ansi-blue-fg">=</span>placement<span class="ansi-blue-fg">,</span> ndim<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/managers.py</span> in <span class="ansi-cyan-fg">_stack_arrays</span><span class="ansi-blue-fg">(tuples, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">   1878</span>     shape <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>arrays<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> _shape_compat<span class="ansi-blue-fg">(</span>first<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1879</span> 
<span class="ansi-green-fg">-&gt; 1880</span><span class="ansi-red-fg">     </span>stacked <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>empty<span class="ansi-blue-fg">(</span>shape<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1881</span>     <span class="ansi-green-fg">for</span> i<span class="ansi-blue-fg">,</span> arr <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>arrays<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1882</span>         stacked<span class="ansi-blue-fg">[</span>i<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> _asarray_compat<span class="ansi-blue-fg">(</span>arr<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">MemoryError</span>: Unable to allocate 2.18 GiB for an array with shape (29316, 10000) and data type float64</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">all_results</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>205212</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_results</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>rsid</th>
      <th>rs145069787</th>
      <th>rs12723953</th>
      <th>rs76539137</th>
      <th>rs72895585</th>
      <th>rs183954195</th>
      <th>rs185007189</th>
      <th>rs7556636</th>
      <th>rs145966388</th>
      <th>rs79421110</th>
      <th>rs74070515</th>
      <th>...</th>
      <th>rs77074766</th>
      <th>rs78929403</th>
      <th>rs3738168</th>
      <th>rs3820344</th>
      <th>rs185497873</th>
      <th>rs150084180</th>
      <th>rs72671670</th>
      <th>rs144804148</th>
      <th>rs78101999</th>
      <th>rs79916150</th>
    </tr>
    <tr>
      <th>sample_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sample1007</th>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
      <td>CC</td>
      <td>TT</td>
      <td>AA</td>
      <td>GG</td>
      <td>AA</td>
      <td>GG</td>
      <td>CC</td>
      <td>...</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>AA</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>TT</td>
      <td>CC</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 9482 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">all_results</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-25-73c7aebfa580&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>all_results <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>result<span class="ansi-blue-fg">.</span>T <span class="ansi-green-fg">for</span> result <span class="ansi-green-fg">in</span> tqdm<span class="ansi-blue-fg">(</span>all_results<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">&lt;ipython-input-25-73c7aebfa580&gt;</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>all_results <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>result<span class="ansi-blue-fg">.</span>T <span class="ansi-green-fg">for</span> result <span class="ansi-green-fg">in</span> tqdm<span class="ansi-blue-fg">(</span>all_results<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/frame.py</span> in <span class="ansi-cyan-fg">T</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   2927</span>     <span class="ansi-blue-fg">@</span>property
<span class="ansi-green-intense-fg ansi-bold">   2928</span>     <span class="ansi-green-fg">def</span> T<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> DataFrame<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2929</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>transpose<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2930</span> 
<span class="ansi-green-intense-fg ansi-bold">   2931</span>     <span class="ansi-red-fg"># ----------------------------------------------------------------------</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/frame.py</span> in <span class="ansi-cyan-fg">transpose</span><span class="ansi-blue-fg">(self, copy, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">   2919</span>             <span class="ansi-green-fg">if</span> copy<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2920</span>                 new_values <span class="ansi-blue-fg">=</span> new_values<span class="ansi-blue-fg">.</span>copy<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 2921</span><span class="ansi-red-fg">             result = self._constructor(
</span><span class="ansi-green-intense-fg ansi-bold">   2922</span>                 new_values<span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>columns<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>index
<span class="ansi-green-intense-fg ansi-bold">   2923</span>             )

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/frame.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, data, index, columns, dtype, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    556</span>                 mgr <span class="ansi-blue-fg">=</span> init_dict<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">{</span>data<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">:</span> data<span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    557</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 558</span><span class="ansi-red-fg">                 </span>mgr <span class="ansi-blue-fg">=</span> init_ndarray<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span>copy<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    559</span> 
<span class="ansi-green-intense-fg ansi-bold">    560</span>         <span class="ansi-red-fg"># For data is list-like, or Iterable (will consume into list)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/construction.py</span> in <span class="ansi-cyan-fg">init_ndarray</span><span class="ansi-blue-fg">(values, index, columns, dtype, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    225</span> 
<span class="ansi-green-intense-fg ansi-bold">    226</span>             <span class="ansi-red-fg"># TODO: What about re-joining object columns?</span>
<span class="ansi-green-fg">--&gt; 227</span><span class="ansi-red-fg">             block_values = [
</span><span class="ansi-green-intense-fg ansi-bold">    228</span>                 make_block<span class="ansi-blue-fg">(</span>dvals_list<span class="ansi-blue-fg">[</span>n<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> placement<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span>n<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> ndim<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>                 <span class="ansi-green-fg">for</span> n <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>dvals_list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/construction.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    226</span>             <span class="ansi-red-fg"># TODO: What about re-joining object columns?</span>
<span class="ansi-green-intense-fg ansi-bold">    227</span>             block_values = [
<span class="ansi-green-fg">--&gt; 228</span><span class="ansi-red-fg">                 </span>make_block<span class="ansi-blue-fg">(</span>dvals_list<span class="ansi-blue-fg">[</span>n<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> placement<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span>n<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> ndim<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>                 <span class="ansi-green-fg">for</span> n <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>dvals_list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    230</span>             ]

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/blocks.py</span> in <span class="ansi-cyan-fg">make_block</span><span class="ansi-blue-fg">(values, placement, klass, ndim, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">   2730</span>         values <span class="ansi-blue-fg">=</span> DatetimeArray<span class="ansi-blue-fg">.</span>_simple_new<span class="ansi-blue-fg">(</span>values<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2731</span> 
<span class="ansi-green-fg">-&gt; 2732</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> klass<span class="ansi-blue-fg">(</span>values<span class="ansi-blue-fg">,</span> ndim<span class="ansi-blue-fg">=</span>ndim<span class="ansi-blue-fg">,</span> placement<span class="ansi-blue-fg">=</span>placement<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2733</span> 
<span class="ansi-green-intense-fg ansi-bold">   2734</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/blocks.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, values, placement, ndim)</span>
<span class="ansi-green-intense-fg ansi-bold">    136</span>         <span class="ansi-red-fg"># TODO(EA2D): ndim will be unnecessary with 2D EAs</span>
<span class="ansi-green-intense-fg ansi-bold">    137</span>         self<span class="ansi-blue-fg">.</span>ndim <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_check_ndim<span class="ansi-blue-fg">(</span>values<span class="ansi-blue-fg">,</span> ndim<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 138</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>mgr_locs <span class="ansi-blue-fg">=</span> placement
<span class="ansi-green-intense-fg ansi-bold">    139</span>         self<span class="ansi-blue-fg">.</span>values <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_maybe_coerce_values<span class="ansi-blue-fg">(</span>values<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    140</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/blocks.py</span> in <span class="ansi-cyan-fg">mgr_locs</span><span class="ansi-blue-fg">(self, new_mgr_locs)</span>
<span class="ansi-green-intense-fg ansi-bold">    270</span>     <span class="ansi-green-fg">def</span> mgr_locs<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> new_mgr_locs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>new_mgr_locs<span class="ansi-blue-fg">,</span> libinternals<span class="ansi-blue-fg">.</span>BlockPlacement<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 272</span><span class="ansi-red-fg">             </span>new_mgr_locs <span class="ansi-blue-fg">=</span> libinternals<span class="ansi-blue-fg">.</span>BlockPlacement<span class="ansi-blue-fg">(</span>new_mgr_locs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    273</span> 
<span class="ansi-green-intense-fg ansi-bold">    274</span>         self<span class="ansi-blue-fg">.</span>_mgr_locs <span class="ansi-blue-fg">=</span> new_mgr_locs

<span class="ansi-green-fg">pandas/_libs/internals.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.internals.BlockPlacement.__init__</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/numpy/core/_asarray.py</span> in <span class="ansi-cyan-fg">require</span><span class="ansi-blue-fg">(a, dtype, requirements)</span>
<span class="ansi-green-intense-fg ansi-bold">    314</span>         requirements<span class="ansi-blue-fg">.</span>remove<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;C&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    315</span> 
<span class="ansi-green-fg">--&gt; 316</span><span class="ansi-red-fg">     </span>arr <span class="ansi-blue-fg">=</span> array<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">,</span> order<span class="ansi-blue-fg">=</span>order<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> subok<span class="ansi-blue-fg">=</span>subok<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    317</span> 
<span class="ansi-green-intense-fg ansi-bold">    318</span>     <span class="ansi-green-fg">for</span> prop <span class="ansi-green-fg">in</span> requirements<span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_results</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">MemoryError</span>                               Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-22-04d20fc0c96b&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>pd<span class="ansi-blue-fg">.</span>concat<span class="ansi-blue-fg">(</span>all_results<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">concat</span><span class="ansi-blue-fg">(objs, axis, join, ignore_index, keys, levels, names, verify_integrity, sort, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    296</span>     )
<span class="ansi-green-intense-fg ansi-bold">    297</span> 
<span class="ansi-green-fg">--&gt; 298</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> op<span class="ansi-blue-fg">.</span>get_result<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    299</span> 
<span class="ansi-green-intense-fg ansi-bold">    300</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">get_result</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    518</span>                 mgrs_indexers<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>obj<span class="ansi-blue-fg">.</span>_mgr<span class="ansi-blue-fg">,</span> indexers<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    519</span> 
<span class="ansi-green-fg">--&gt; 520</span><span class="ansi-red-fg">             new_data = concatenate_block_managers(
</span><span class="ansi-green-intense-fg ansi-bold">    521</span>                 mgrs_indexers<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>new_axes<span class="ansi-blue-fg">,</span> concat_axis<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>bm_axis<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>copy
<span class="ansi-green-intense-fg ansi-bold">    522</span>             )

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/concat.py</span> in <span class="ansi-cyan-fg">concatenate_block_managers</span><span class="ansi-blue-fg">(mgrs_indexers, axes, concat_axis, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">     81</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     82</span>             b = make_block(
<span class="ansi-green-fg">---&gt; 83</span><span class="ansi-red-fg">                 </span>_concatenate_join_units<span class="ansi-blue-fg">(</span>join_units<span class="ansi-blue-fg">,</span> concat_axis<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span>copy<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     84</span>                 placement<span class="ansi-blue-fg">=</span>placement<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     85</span>                 ndim<span class="ansi-blue-fg">=</span>len<span class="ansi-blue-fg">(</span>axes<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/concat.py</span> in <span class="ansi-cyan-fg">_concatenate_join_units</span><span class="ansi-blue-fg">(join_units, concat_axis, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    341</span>             concat_values <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>atleast_2d<span class="ansi-blue-fg">(</span>concat_values<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    342</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 343</span><span class="ansi-red-fg">         </span>concat_values <span class="ansi-blue-fg">=</span> concat_compat<span class="ansi-blue-fg">(</span>to_concat<span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">=</span>concat_axis<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    344</span> 
<span class="ansi-green-intense-fg ansi-bold">    345</span>     <span class="ansi-green-fg">return</span> concat_values

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/dtypes/concat.py</span> in <span class="ansi-cyan-fg">concat_compat</span><span class="ansi-blue-fg">(to_concat, axis)</span>
<span class="ansi-green-intense-fg ansi-bold">    169</span>                 to_concat <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>x<span class="ansi-blue-fg">.</span>astype<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;object&#34;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> to_concat<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    170</span> 
<span class="ansi-green-fg">--&gt; 171</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> np<span class="ansi-blue-fg">.</span>concatenate<span class="ansi-blue-fg">(</span>to_concat<span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">=</span>axis<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    172</span> 
<span class="ansi-green-intense-fg ansi-bold">    173</span> 

<span class="ansi-green-fg">&lt;__array_function__ internals&gt;</span> in <span class="ansi-cyan-fg">concatenate</span><span class="ansi-blue-fg">(*args, **kwargs)</span>

<span class="ansi-red-fg">MemoryError</span>: Unable to allocate 7.28 GiB for an array with shape (1, 977200000) and data type object</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> <span class="p">[</span><span class="n">triplicate_converter</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="p">,</span> <span class="n">genotype_df</span><span class="o">=</span> <span class="n">geno_df</span><span class="p">,</span> <span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_func</span><span class="p">(</span><span class="n">test</span><span class="p">))</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   2060</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2061</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_reader<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2062</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader.read</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._read_low_memory</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers._concatenate_chunks</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/dtypes/common.py</span> in <span class="ansi-cyan-fg">is_categorical_dtype</span><span class="ansi-blue-fg">(arr_or_dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> 
<span class="ansi-green-fg">--&gt; 537</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">def</span> is_categorical_dtype<span class="ansi-blue-fg">(</span>arr_or_dtype<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> bool<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    538</span>     &#34;&#34;&#34;

<span class="ansi-red-fg">KeyboardInterrupt</span>: 

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-127-845b7f2679b9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>all_results <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>triplicate_converter<span class="ansi-blue-fg">(</span>sample<span class="ansi-blue-fg">.</span>sample_df<span class="ansi-blue-fg">,</span> genotype_df<span class="ansi-blue-fg">=</span> geno_df<span class="ansi-blue-fg">,</span> sample_id <span class="ansi-blue-fg">=</span> sample<span class="ansi-blue-fg">.</span>sample_id<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> sample <span class="ansi-green-fg">in</span> tqdm<span class="ansi-blue-fg">(</span>test_func<span class="ansi-blue-fg">(</span>test<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> test <span class="ansi-green-fg">in</span> test_generator<span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">&lt;ipython-input-127-845b7f2679b9&gt;</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>all_results <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>triplicate_converter<span class="ansi-blue-fg">(</span>sample<span class="ansi-blue-fg">.</span>sample_df<span class="ansi-blue-fg">,</span> genotype_df<span class="ansi-blue-fg">=</span> geno_df<span class="ansi-blue-fg">,</span> sample_id <span class="ansi-blue-fg">=</span> sample<span class="ansi-blue-fg">.</span>sample_id<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> sample <span class="ansi-green-fg">in</span> tqdm<span class="ansi-blue-fg">(</span>test_func<span class="ansi-blue-fg">(</span>test<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> test <span class="ansi-green-fg">in</span> test_generator<span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">__next__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1032</span>     <span class="ansi-green-fg">def</span> __next__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1033</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1034</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>get_chunk<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1035</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1036</span>             self<span class="ansi-blue-fg">.</span>close<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">get_chunk</span><span class="ansi-blue-fg">(self, size)</span>
<span class="ansi-green-intense-fg ansi-bold">   1082</span>                 <span class="ansi-green-fg">raise</span> StopIteration
<span class="ansi-green-intense-fg ansi-bold">   1083</span>             size <span class="ansi-blue-fg">=</span> min<span class="ansi-blue-fg">(</span>size<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>nrows <span class="ansi-blue-fg">-</span> self<span class="ansi-blue-fg">.</span>_currow<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1084</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">=</span>size<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1085</span> 
<span class="ansi-green-intense-fg ansi-bold">   1086</span>     <span class="ansi-green-fg">def</span> __enter__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   1055</span>     <span class="ansi-green-fg">def</span> read<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1056</span>         nrows <span class="ansi-blue-fg">=</span> validate_integer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;nrows&#34;</span><span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1057</span><span class="ansi-red-fg">         </span>index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">,</span> col_dict <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_engine<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1058</span> 
<span class="ansi-green-intense-fg ansi-bold">   1059</span>         <span class="ansi-green-fg">if</span> index <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   2059</span>     <span class="ansi-green-fg">def</span> read<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2060</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2061</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_reader<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2062</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2063</span>             <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_first_chunk<span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_generator</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">chrom</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">found_rsid_set</span><span class="p">,</span> <span class="n">chunksize</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_ddf</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/lab/corradin_dbgap/WTCCC2_all_controls_MS_UC/IMPUTE2_ALL/ALL_MS_impute2_chr22.gen&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">load_args</span><span class="p">,</span> <span class="n">assume_missing</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rsid_list</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="n">found_rsid_set</span><span class="p">),</span> <span class="n">sample</span><span class="o">=</span><span class="mi">4_000_000</span><span class="p">)</span>
<span class="n">test_ddf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-75-a067f0479787&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>test_ddf <span class="ansi-blue-fg">=</span> dd<span class="ansi-blue-fg">.</span>read_csv<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;/lab/corradin_dbgap/WTCCC2_all_controls_MS_UC/IMPUTE2_ALL/ALL_MS_impute2_chr22.gen&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>big_gen_file<span class="ansi-blue-fg">.</span>load_args<span class="ansi-blue-fg">,</span> assume_missing <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> skiprows<span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>set<span class="ansi-blue-fg">(</span>rsid_list<span class="ansi-blue-fg">.</span>index<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-</span> found_rsid_set<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> sample<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">4_000_000</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> test_ddf

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/dask/dataframe/io/csv.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(urlpath, blocksize, lineterminator, compression, sample, enforce, assume_missing, storage_options, include_path_column, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    691</span>         <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    692</span>     ):
<span class="ansi-green-fg">--&gt; 693</span><span class="ansi-red-fg">         return read_pandas(
</span><span class="ansi-green-intense-fg ansi-bold">    694</span>             reader<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    695</span>             urlpath<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/dask/dataframe/io/csv.py</span> in <span class="ansi-cyan-fg">read_pandas</span><span class="ansi-blue-fg">(reader, urlpath, blocksize, lineterminator, compression, sample, enforce, assume_missing, storage_options, include_path_column, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    561</span> 
<span class="ansi-green-intense-fg ansi-bold">    562</span>     <span class="ansi-green-fg">if</span> sample <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">False</span> <span class="ansi-green-fg">and</span> nparts <span class="ansi-blue-fg">&lt;</span> lastskiprow <span class="ansi-blue-fg">+</span> need <span class="ansi-green-fg">and</span> len<span class="ansi-blue-fg">(</span>b_sample<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&gt;=</span> sample<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 563</span><span class="ansi-red-fg">         raise ValueError(
</span><span class="ansi-green-intense-fg ansi-bold">    564</span>             <span class="ansi-blue-fg">&#34;Sample is not large enough to include at least one &#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    565</span>             <span class="ansi-blue-fg">&#34;row of data. Please increase the number of bytes &#34;</span>

<span class="ansi-red-fg">ValueError</span>: Sample is not large enough to include at least one row of data. Please increase the number of bytes in `sample` in the call to `read_csv`/`read_table`</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># for df in tqdm(test_generator):</span>
<span class="c1">#     if df.index.item() in found_rsid_set:</span>
<span class="c1">#         all_dfs.append(df)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">all_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_generator</span><span class="p">):</span>
    <span class="n">all_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 4min 49s, sys: 8.56 s, total: 4min 57s
Wall time: 4min 57s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">all_dfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dashes</th>
      <th>position</th>
      <th>ref</th>
      <th>alt</th>
      <th>sample1_1</th>
      <th>sample1_2</th>
      <th>sample1_3</th>
      <th>sample2_1</th>
      <th>sample2_2</th>
      <th>sample2_3</th>
      <th>...</th>
      <th>sample9769_3</th>
      <th>sample9770_1</th>
      <th>sample9770_2</th>
      <th>sample9770_3</th>
      <th>sample9771_1</th>
      <th>sample9771_2</th>
      <th>sample9771_3</th>
      <th>sample9772_1</th>
      <th>sample9772_2</th>
      <th>sample9772_3</th>
    </tr>
    <tr>
      <th>rsid</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rs140559483</th>
      <td>---</td>
      <td>45001033</td>
      <td>G</td>
      <td>A</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>rs111430943</th>
      <td>---</td>
      <td>45001475</td>
      <td>C</td>
      <td>T</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>rs150368261</th>
      <td>---</td>
      <td>45002259</td>
      <td>C</td>
      <td>T</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>rs147355609</th>
      <td>---</td>
      <td>45004037</td>
      <td>G</td>
      <td>A</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.513</td>
      <td>0.487</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>rs75947718</th>
      <td>---</td>
      <td>45005535</td>
      <td>A</td>
      <td>G</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>rs116544829</th>
      <td>---</td>
      <td>46358224</td>
      <td>T</td>
      <td>A</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>rs116020280</th>
      <td>---</td>
      <td>46358272</td>
      <td>C</td>
      <td>T</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>rs191993184</th>
      <td>---</td>
      <td>46358810</td>
      <td>G</td>
      <td>C</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.999</td>
      <td>0.001</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>rs140592207</th>
      <td>---</td>
      <td>46359202</td>
      <td>C</td>
      <td>T</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>rs10890365</th>
      <td>---</td>
      <td>46359348</td>
      <td>C</td>
      <td>T</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 29320 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_sample</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">test_func</span><span class="p">(</span><span class="n">test_df</span><span class="p">))</span>
<span class="n">first_sample</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>namespace(sample_df=             sample1_1  sample1_2  sample1_3
rsid                                        
rs187800412          1          0          0
rs172018             0          1          0
rs156255             0          0          1
rs78861936           1          0          0
rs112163323          1          0          0
rs117407275          1          0          0
rs139974854          1          0          0
rs192704760          1          0          0
rs270766             0          1          0
rs181242035          1          0          0, sample_id=&#39;sample1&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">triplicate_converter</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">sample_df</span><span class="p">,</span> <span class="n">genotype_df</span><span class="o">=</span> <span class="n">geno_df</span><span class="p">,</span> <span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_func</span><span class="p">(</span><span class="n">test_df</span><span class="p">))]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-89-ae2085d1967e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-blue-fg">[</span>triplicate_converter<span class="ansi-blue-fg">(</span>sample<span class="ansi-blue-fg">.</span>sample_df<span class="ansi-blue-fg">,</span> genotype_df<span class="ansi-blue-fg">=</span> geno_df<span class="ansi-blue-fg">,</span> sample_id <span class="ansi-blue-fg">=</span> sample<span class="ansi-blue-fg">.</span>sample_id<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> sample <span class="ansi-green-fg">in</span> tqdm<span class="ansi-blue-fg">(</span>test_func<span class="ansi-blue-fg">(</span>test_df<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">&lt;ipython-input-89-ae2085d1967e&gt;</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-blue-fg">[</span>triplicate_converter<span class="ansi-blue-fg">(</span>sample<span class="ansi-blue-fg">.</span>sample_df<span class="ansi-blue-fg">,</span> genotype_df<span class="ansi-blue-fg">=</span> geno_df<span class="ansi-blue-fg">,</span> sample_id <span class="ansi-blue-fg">=</span> sample<span class="ansi-blue-fg">.</span>sample_id<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> sample <span class="ansi-green-fg">in</span> tqdm<span class="ansi-blue-fg">(</span>test_func<span class="ansi-blue-fg">(</span>test_df<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">&lt;ipython-input-53-6b8565cd2497&gt;</span> in <span class="ansi-cyan-fg">triplicate_converter</span><span class="ansi-blue-fg">(sample_df, genotype_df, sample_id, high_lim, low_lim, NA_val)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span>         <span class="ansi-red-fg">#all_geno = SimpleNamespace(**test_genfile_format.get_genotypes_df().loc[rsid])</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> 
<span class="ansi-green-fg">---&gt; 11</span><span class="ansi-red-fg">         </span>geno_1<span class="ansi-blue-fg">,</span> geno_2<span class="ansi-blue-fg">,</span> geno_3 <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>sample_df<span class="ansi-blue-fg">.</span>astype<span class="ansi-blue-fg">(</span>float<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span>col<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> col <span class="ansi-green-fg">in</span> sample_df<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>         homo_ref_cond <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>geno_1 <span class="ansi-blue-fg">&gt;=</span>high_lim<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>geno_2 <span class="ansi-blue-fg">&lt;</span> low_lim<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>geno_3 <span class="ansi-blue-fg">&lt;</span> low_lim<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>         het_cond <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>geno_2 <span class="ansi-blue-fg">&gt;=</span> high_lim<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>geno_1 <span class="ansi-blue-fg">&lt;</span> low_lim<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>geno_3 <span class="ansi-blue-fg">&lt;</span> low_lim<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-53-6b8565cd2497&gt;</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span>         <span class="ansi-red-fg">#all_geno = SimpleNamespace(**test_genfile_format.get_genotypes_df().loc[rsid])</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> 
<span class="ansi-green-fg">---&gt; 11</span><span class="ansi-red-fg">         </span>geno_1<span class="ansi-blue-fg">,</span> geno_2<span class="ansi-blue-fg">,</span> geno_3 <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>sample_df<span class="ansi-blue-fg">.</span>astype<span class="ansi-blue-fg">(</span>float<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span>col<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> col <span class="ansi-green-fg">in</span> sample_df<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>         homo_ref_cond <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>geno_1 <span class="ansi-blue-fg">&gt;=</span>high_lim<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>geno_2 <span class="ansi-blue-fg">&lt;</span> low_lim<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>geno_3 <span class="ansi-blue-fg">&lt;</span> low_lim<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>         het_cond <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>geno_2 <span class="ansi-blue-fg">&gt;=</span> high_lim<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>geno_1 <span class="ansi-blue-fg">&lt;</span> low_lim<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>geno_3 <span class="ansi-blue-fg">&lt;</span> low_lim<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/generic.py</span> in <span class="ansi-cyan-fg">astype</span><span class="ansi-blue-fg">(self, dtype, copy, errors)</span>
<span class="ansi-green-intense-fg ansi-bold">   5872</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   5873</span>             <span class="ansi-red-fg"># else, only a single dtype is given</span>
<span class="ansi-green-fg">-&gt; 5874</span><span class="ansi-red-fg">             </span>new_data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_mgr<span class="ansi-blue-fg">.</span>astype<span class="ansi-blue-fg">(</span>dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span>copy<span class="ansi-blue-fg">,</span> errors<span class="ansi-blue-fg">=</span>errors<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   5875</span>             <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_constructor<span class="ansi-blue-fg">(</span>new_data<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__finalize__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> method<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;astype&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   5876</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/managers.py</span> in <span class="ansi-cyan-fg">astype</span><span class="ansi-blue-fg">(self, dtype, copy, errors)</span>
<span class="ansi-green-intense-fg ansi-bold">    629</span>         self<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">:</span> bool <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> errors<span class="ansi-blue-fg">:</span> str <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#34;raise&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    630</span>     ) -&gt; &#34;BlockManager&#34;:
<span class="ansi-green-fg">--&gt; 631</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>apply<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;astype&#34;</span><span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span>copy<span class="ansi-blue-fg">,</span> errors<span class="ansi-blue-fg">=</span>errors<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    632</span> 
<span class="ansi-green-intense-fg ansi-bold">    633</span>     def convert(

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/managers.py</span> in <span class="ansi-cyan-fg">apply</span><span class="ansi-blue-fg">(self, f, align_keys, ignore_failures, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    425</span>                     applied <span class="ansi-blue-fg">=</span> b<span class="ansi-blue-fg">.</span>apply<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    426</span>                 <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 427</span><span class="ansi-red-fg">                     </span>applied <span class="ansi-blue-fg">=</span> getattr<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    428</span>             <span class="ansi-green-fg">except</span> <span class="ansi-blue-fg">(</span>TypeError<span class="ansi-blue-fg">,</span> NotImplementedError<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    429</span>                 <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> ignore_failures<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/blocks.py</span> in <span class="ansi-cyan-fg">astype</span><span class="ansi-blue-fg">(self, dtype, copy, errors)</span>
<span class="ansi-green-intense-fg ansi-bold">    638</span> 
<span class="ansi-green-intense-fg ansi-bold">    639</span>         <span class="ansi-red-fg"># astype processing</span>
<span class="ansi-green-fg">--&gt; 640</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">if</span> is_dtype_equal<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dtype<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    641</span>             <span class="ansi-green-fg">if</span> copy<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    642</span>                 <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>copy<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/blocks.py</span> in <span class="ansi-cyan-fg">dtype</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    345</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">.</span>shape
<span class="ansi-green-intense-fg ansi-bold">    346</span> 
<span class="ansi-green-fg">--&gt; 347</span><span class="ansi-red-fg">     </span><span class="ansi-blue-fg">@</span>property
<span class="ansi-green-intense-fg ansi-bold">    348</span>     <span class="ansi-green-fg">def</span> dtype<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    349</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">.</span>dtype

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_dfs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-163-8da579fe6ca2&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>pd<span class="ansi-blue-fg">.</span>concat<span class="ansi-blue-fg">(</span>all_dfs<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">concat</span><span class="ansi-blue-fg">(objs, axis, join, ignore_index, keys, levels, names, verify_integrity, sort, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    296</span>     )
<span class="ansi-green-intense-fg ansi-bold">    297</span> 
<span class="ansi-green-fg">--&gt; 298</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> op<span class="ansi-blue-fg">.</span>get_result<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    299</span> 
<span class="ansi-green-intense-fg ansi-bold">    300</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">get_result</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    518</span>                 mgrs_indexers<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>obj<span class="ansi-blue-fg">.</span>_mgr<span class="ansi-blue-fg">,</span> indexers<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    519</span> 
<span class="ansi-green-fg">--&gt; 520</span><span class="ansi-red-fg">             new_data = concatenate_block_managers(
</span><span class="ansi-green-intense-fg ansi-bold">    521</span>                 mgrs_indexers<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>new_axes<span class="ansi-blue-fg">,</span> concat_axis<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>bm_axis<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>copy
<span class="ansi-green-intense-fg ansi-bold">    522</span>             )

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/concat.py</span> in <span class="ansi-cyan-fg">concatenate_block_managers</span><span class="ansi-blue-fg">(mgrs_indexers, axes, concat_axis, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">     81</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     82</span>             b = make_block(
<span class="ansi-green-fg">---&gt; 83</span><span class="ansi-red-fg">                 </span>_concatenate_join_units<span class="ansi-blue-fg">(</span>join_units<span class="ansi-blue-fg">,</span> concat_axis<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span>copy<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     84</span>                 placement<span class="ansi-blue-fg">=</span>placement<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     85</span>                 ndim<span class="ansi-blue-fg">=</span>len<span class="ansi-blue-fg">(</span>axes<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/concat.py</span> in <span class="ansi-cyan-fg">_concatenate_join_units</span><span class="ansi-blue-fg">(join_units, concat_axis, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    311</span>     empty_dtype<span class="ansi-blue-fg">,</span> upcasted_na <span class="ansi-blue-fg">=</span> _get_empty_dtype_and_na<span class="ansi-blue-fg">(</span>join_units<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    312</span> 
<span class="ansi-green-fg">--&gt; 313</span><span class="ansi-red-fg">     to_concat = [
</span><span class="ansi-green-intense-fg ansi-bold">    314</span>         ju<span class="ansi-blue-fg">.</span>get_reindexed_values<span class="ansi-blue-fg">(</span>empty_dtype<span class="ansi-blue-fg">=</span>empty_dtype<span class="ansi-blue-fg">,</span> upcasted_na<span class="ansi-blue-fg">=</span>upcasted_na<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    315</span>         <span class="ansi-green-fg">for</span> ju <span class="ansi-green-fg">in</span> join_units

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/concat.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    312</span> 
<span class="ansi-green-intense-fg ansi-bold">    313</span>     to_concat = [
<span class="ansi-green-fg">--&gt; 314</span><span class="ansi-red-fg">         </span>ju<span class="ansi-blue-fg">.</span>get_reindexed_values<span class="ansi-blue-fg">(</span>empty_dtype<span class="ansi-blue-fg">=</span>empty_dtype<span class="ansi-blue-fg">,</span> upcasted_na<span class="ansi-blue-fg">=</span>upcasted_na<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    315</span>         <span class="ansi-green-fg">for</span> ju <span class="ansi-green-fg">in</span> join_units
<span class="ansi-green-intense-fg ansi-bold">    316</span>     ]

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/internals/concat.py</span> in <span class="ansi-cyan-fg">get_reindexed_values</span><span class="ansi-blue-fg">(self, empty_dtype, upcasted_na)</span>
<span class="ansi-green-intense-fg ansi-bold">    296</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    297</span>             <span class="ansi-green-fg">for</span> ax<span class="ansi-blue-fg">,</span> indexer <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>indexers<span class="ansi-blue-fg">.</span>items<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 298</span><span class="ansi-red-fg">                 </span>values <span class="ansi-blue-fg">=</span> algos<span class="ansi-blue-fg">.</span>take_nd<span class="ansi-blue-fg">(</span>values<span class="ansi-blue-fg">,</span> indexer<span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">=</span>ax<span class="ansi-blue-fg">,</span> fill_value<span class="ansi-blue-fg">=</span>fill_value<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    299</span> 
<span class="ansi-green-intense-fg ansi-bold">    300</span>         <span class="ansi-green-fg">return</span> values

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/algorithms.py</span> in <span class="ansi-cyan-fg">take_nd</span><span class="ansi-blue-fg">(arr, indexer, axis, out, fill_value, allow_fill)</span>
<span class="ansi-green-intense-fg ansi-bold">   1754</span>             out <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>empty<span class="ansi-blue-fg">(</span>out_shape<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1755</span> 
<span class="ansi-green-fg">-&gt; 1756</span><span class="ansi-red-fg">     func = _get_take_nd_function(
</span><span class="ansi-green-intense-fg ansi-bold">   1757</span>         arr<span class="ansi-blue-fg">.</span>ndim<span class="ansi-blue-fg">,</span> arr<span class="ansi-blue-fg">.</span>dtype<span class="ansi-blue-fg">,</span> out<span class="ansi-blue-fg">.</span>dtype<span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">=</span>axis<span class="ansi-blue-fg">,</span> mask_info<span class="ansi-blue-fg">=</span>mask_info
<span class="ansi-green-intense-fg ansi-bold">   1758</span>     )

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/algorithms.py</span> in <span class="ansi-cyan-fg">_get_take_nd_function</span><span class="ansi-blue-fg">(ndim, arr_dtype, out_dtype, axis, mask_info)</span>
<span class="ansi-green-intense-fg ansi-bold">   1536</span> ):
<span class="ansi-green-intense-fg ansi-bold">   1537</span>     <span class="ansi-green-fg">if</span> ndim <span class="ansi-blue-fg">&lt;=</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1538</span><span class="ansi-red-fg">         </span>tup <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>arr_dtype<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">,</span> out_dtype<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1539</span>         <span class="ansi-green-fg">if</span> ndim <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1540</span>             func <span class="ansi-blue-fg">=</span> _take_1d_dict<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span>tup<span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/numpy/core/_dtype.py</span> in <span class="ansi-cyan-fg">_name_get</span><span class="ansi-blue-fg">(dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">    334</span>     <span class="ansi-red-fg"># append bit counts</span>
<span class="ansi-green-intense-fg ansi-bold">    335</span>     <span class="ansi-green-fg">if</span> _name_includes_bit_suffix<span class="ansi-blue-fg">(</span>dtype<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 336</span><span class="ansi-red-fg">         </span>name <span class="ansi-blue-fg">+=</span> <span class="ansi-blue-fg">&#34;{}&#34;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>dtype<span class="ansi-blue-fg">.</span>itemsize <span class="ansi-blue-fg">*</span> <span class="ansi-cyan-fg">8</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    337</span> 
<span class="ansi-green-intense-fg ansi-bold">    338</span>     <span class="ansi-red-fg"># append metadata to datetimes</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">index_search</span><span class="p">(</span><span class="n">rsid_list</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[</span><span class="s2">&quot;fake_rsid&quot;</span><span class="p">]</span>  <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">rsid_list</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1627547, 1111766,  341437, 1970714, 1105928, 2135379,  240617,
        987551, 1623188,  433210, 1739584])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rsid_list</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file_iterator</span> <span class="o">=</span> <span class="n">big_gen_file</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span><span class="p">])</span>
<span class="n">big_gen_file_iterator</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;pandas.io.parsers.TextFileReader at 0x14d08952ab20&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">big_gen_file_iterator</span><span class="p">)</span><span class="c1">#.loc[[&#39;rs77948203&#39;, &#39;rs1014626&#39;]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   2055</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2056</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_reader<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2057</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader.read</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._read_low_memory</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._read_rows</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._convert_column_data</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._convert_tokens</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._convert_with_dtype</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/dtypes/common.py</span> in <span class="ansi-cyan-fg">is_categorical_dtype</span><span class="ansi-blue-fg">(arr_or_dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">    536</span> 
<span class="ansi-green-fg">--&gt; 537</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">def</span> is_categorical_dtype<span class="ansi-blue-fg">(</span>arr_or_dtype<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> bool<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    538</span>     &#34;&#34;&#34;

<span class="ansi-red-fg">KeyboardInterrupt</span>: 

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-79-73a4c3164f55&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>next<span class="ansi-blue-fg">(</span>big_gen_file_iterator<span class="ansi-blue-fg">)</span><span class="ansi-red-fg">#.loc[[&#39;rs77948203&#39;, &#39;rs1014626&#39;]]</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">__next__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1027</span>     <span class="ansi-green-fg">def</span> __next__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1028</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1029</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>get_chunk<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1030</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1031</span>             self<span class="ansi-blue-fg">.</span>close<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">get_chunk</span><span class="ansi-blue-fg">(self, size)</span>
<span class="ansi-green-intense-fg ansi-bold">   1077</span>                 <span class="ansi-green-fg">raise</span> StopIteration
<span class="ansi-green-intense-fg ansi-bold">   1078</span>             size <span class="ansi-blue-fg">=</span> min<span class="ansi-blue-fg">(</span>size<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>nrows <span class="ansi-blue-fg">-</span> self<span class="ansi-blue-fg">.</span>_currow<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1079</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">=</span>size<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1080</span> 
<span class="ansi-green-intense-fg ansi-bold">   1081</span>     <span class="ansi-green-fg">def</span> __enter__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   1050</span>     <span class="ansi-green-fg">def</span> read<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1051</span>         nrows <span class="ansi-blue-fg">=</span> validate_integer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;nrows&#34;</span><span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1052</span><span class="ansi-red-fg">         </span>index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">,</span> col_dict <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_engine<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1053</span> 
<span class="ansi-green-intense-fg ansi-bold">   1054</span>         <span class="ansi-green-fg">if</span> index <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   2054</span>     <span class="ansi-green-fg">def</span> read<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2055</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2056</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_reader<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2057</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2058</span>             <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_first_chunk<span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;rsid&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>  <span class="n">skiprows</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_filtered</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dashes</th>
      <th>rsid</th>
      <th>position</th>
      <th>ref</th>
      <th>alt</th>
      <th>sample1_1</th>
      <th>sample1_2</th>
      <th>sample1_3</th>
      <th>sample2_1</th>
      <th>sample2_2</th>
      <th>...</th>
      <th>sample9769_3</th>
      <th>sample9770_1</th>
      <th>sample9770_2</th>
      <th>sample9770_3</th>
      <th>sample9771_1</th>
      <th>sample9771_2</th>
      <th>sample9771_3</th>
      <th>sample9772_1</th>
      <th>sample9772_2</th>
      <th>sample9772_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>---</td>
      <td>rs77948203</td>
      <td>21249165</td>
      <td>G</td>
      <td>A</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>---</td>
      <td>rs1014626</td>
      <td>21461017</td>
      <td>C</td>
      <td>T</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 29321 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_filtered</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">big_gen_file_iterator</span><span class="p">):</span>
    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span><span class="si">}</span><span class="s2"> in [&#39;rs77948203&#39;, &#39;rs1014626&#39;]&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">all_filtered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> test = big_gen_file.get_rsid_df(chrom=22, rsid_list=[&quot;rs77948203&quot;, &quot;rs9610458&quot;])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 9.92 s, sys: 128 ms, total: 10 s
Wall time: 9.97 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> test.compute()
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">get_full_file_path</span><span class="p">(</span><span class="mi">22</span><span class="p">),</span> <span class="o">**</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">load_args</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rsid</th>
    </tr>
    <tr>
      <th>npartitions=377</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>object</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: read-csv, 377 tasks</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> 
<span class="n">needed_rsids</span> <span class="o">=</span> <span class="n">test_result</span><span class="o">.</span><span class="n">rsid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">ddf</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">get_full_file_path</span><span class="p">(</span><span class="mi">22</span><span class="p">),</span> <span class="o">**</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">load_args</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="n">big_gen_file</span><span class="o">.</span><span class="n">rsid_col</span><span class="p">])</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;rsid&quot;</span><span class="p">)</span>
<span class="n">ddf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 5 µs, sys: 2 µs, total: 7 µs
Wall time: 14.5 µs
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-8-dfbbedb4b45e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> get_ipython<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>run_line_magic<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;time&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>needed_rsids <span class="ansi-blue-fg">=</span> test_result<span class="ansi-blue-fg">.</span>rsid<span class="ansi-blue-fg">.</span>tolist<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> ddf <span class="ansi-blue-fg">=</span> dd<span class="ansi-blue-fg">.</span>read_csv<span class="ansi-blue-fg">(</span>big_gen_file<span class="ansi-blue-fg">.</span>file_path<span class="ansi-blue-fg">.</span>get_full_file_path<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">22</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>big_gen_file<span class="ansi-blue-fg">.</span>load_args<span class="ansi-blue-fg">,</span> usecols<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span>big_gen_file<span class="ansi-blue-fg">.</span>rsid_col<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>set_index<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;rsid&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> ddf

<span class="ansi-red-fg">NameError</span>: name &#39;test_result&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ddf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">needed_rsids</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-124-4be4269c431c&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>ddf<span class="ansi-blue-fg">.</span>loc<span class="ansi-blue-fg">[</span>needed_rsids<span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/dask/dataframe/indexing.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">     97</span>             iindexer <span class="ansi-blue-fg">=</span> key
<span class="ansi-green-intense-fg ansi-bold">     98</span>             cindexer <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">---&gt; 99</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_loc<span class="ansi-blue-fg">(</span>iindexer<span class="ansi-blue-fg">,</span> cindexer<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    100</span> 
<span class="ansi-green-intense-fg ansi-bold">    101</span>     <span class="ansi-green-fg">def</span> _loc<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> iindexer<span class="ansi-blue-fg">,</span> cindexer<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/dask/dataframe/indexing.py</span> in <span class="ansi-cyan-fg">_loc</span><span class="ansi-blue-fg">(self, iindexer, cindexer)</span>
<span class="ansi-green-intense-fg ansi-bold">    123</span>                 <span class="ansi-red-fg"># results in duplicated NaN rows</span>
<span class="ansi-green-intense-fg ansi-bold">    124</span>                 msg <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#34;Cannot index with list against unknown division&#34;</span>
<span class="ansi-green-fg">--&gt; 125</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">raise</span> KeyError<span class="ansi-blue-fg">(</span>msg<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    126</span>             <span class="ansi-green-fg">elif</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>iindexer<span class="ansi-blue-fg">,</span> slice<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    127</span>                 iindexer <span class="ansi-blue-fg">=</span> slice<span class="ansi-blue-fg">(</span>iindexer<span class="ansi-blue-fg">,</span> iindexer<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">KeyError</span>: &#39;Cannot index with list against unknown division&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> test.compute()
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
KeyboardInterrupt

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_genetic_file</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">get_rsid_df</span><span class="p">(</span><span class="n">chrom</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">rsid_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs9610458&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ParserError</span>                               Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-38-9aa3317ee5e8&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>big_genetic_file<span class="ansi-blue-fg">.</span>files<span class="ansi-blue-fg">.</span>case<span class="ansi-blue-fg">.</span>get_rsid_df<span class="ansi-blue-fg">(</span>chrom<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">22</span><span class="ansi-blue-fg">,</span> rsid_list<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;rs77948203&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;rs9610458&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/corradin_ovp_utils/datasets/genetic_file/Gen.py</span> in <span class="ansi-cyan-fg">get_rsid_df</span><span class="ansi-blue-fg">(self, chrom, rsid_list, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    111</span>     <span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>pd<span class="ansi-blue-fg">.</span>read_csv<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    112</span>     <span class="ansi-green-fg">def</span> get_rsid_df<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>chrom<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> rsid_list<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 113</span><span class="ansi-red-fg">         </span>rsid_df <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>load<span class="ansi-blue-fg">(</span>chrom <span class="ansi-blue-fg">=</span> chrom<span class="ansi-blue-fg">,</span> usecols <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>rsid_col<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>         <span class="ansi-green-fg">if</span> rsid_list <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span>             found_rsid_df <span class="ansi-blue-fg">=</span> rsid_df<span class="ansi-blue-fg">.</span>query<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#34;{self.rsid_col} in @rsid_list&#34;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/corradin_ovp_utils/datasets/genetic_file/Gen.py</span> in <span class="ansi-cyan-fg">load</span><span class="ansi-blue-fg">(self, chrom, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    104</span>     <span class="ansi-green-fg">def</span> load<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> chrom<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    105</span>         self<span class="ansi-blue-fg">.</span>current_file_path <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>get_resolved_file_path<span class="ansi-blue-fg">(</span>chrom<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># use another attribute so `load` and `_load_unprocessed` can share</span>
<span class="ansi-green-fg">--&gt; 106</span><span class="ansi-red-fg">         </span>df <span class="ansi-blue-fg">=</span> pd<span class="ansi-blue-fg">.</span>read_csv<span class="ansi-blue-fg">(</span>filepath_or_buffer <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>current_file_path<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>self<span class="ansi-blue-fg">.</span>load_args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    107</span>         <span class="ansi-red-fg">#df.columns = self.column_headers</span>
<span class="ansi-green-intense-fg ansi-bold">    108</span>         <span class="ansi-green-fg">return</span> df

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read_csv</span><span class="ansi-blue-fg">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, dialect, error_bad_lines, warn_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="ansi-green-intense-fg ansi-bold">    603</span>     kwds<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>kwds_defaults<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    604</span> 
<span class="ansi-green-fg">--&gt; 605</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> _read<span class="ansi-blue-fg">(</span>filepath_or_buffer<span class="ansi-blue-fg">,</span> kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    606</span> 
<span class="ansi-green-intense-fg ansi-bold">    607</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">_read</span><span class="ansi-blue-fg">(filepath_or_buffer, kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    461</span> 
<span class="ansi-green-intense-fg ansi-bold">    462</span>     <span class="ansi-green-fg">with</span> parser<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 463</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> parser<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    464</span> 
<span class="ansi-green-intense-fg ansi-bold">    465</span> 

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   1050</span>     <span class="ansi-green-fg">def</span> read<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1051</span>         nrows <span class="ansi-blue-fg">=</span> validate_integer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;nrows&#34;</span><span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1052</span><span class="ansi-red-fg">         </span>index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">,</span> col_dict <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_engine<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1053</span> 
<span class="ansi-green-intense-fg ansi-bold">   1054</span>         <span class="ansi-green-fg">if</span> index <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, nrows)</span>
<span class="ansi-green-intense-fg ansi-bold">   2054</span>     <span class="ansi-green-fg">def</span> read<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2055</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2056</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_reader<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span>nrows<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2057</span>         <span class="ansi-green-fg">except</span> StopIteration<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2058</span>             <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_first_chunk<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader.read</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._read_low_memory</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._read_rows</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._tokenize_rows</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">pandas/_libs/parsers.pyx</span> in <span class="ansi-cyan-fg">pandas._libs.parsers.raise_parser_error</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">ParserError</span>: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine=&#39;python&#39;.</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> big_genetic_file.files.case.load(chrom= 22, usecols =[big_genetic_file.files.case.rsid_col], chunksize=1000)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 2min 7s, sys: 8.66 s, total: 2min 16s
Wall time: 2min 28s
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rsid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rs149201999</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rs146752890</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rs139377059</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rs188945759</td>
    </tr>
    <tr>
      <th>4</th>
      <td>rs6518357</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>365639</th>
      <td>rs188271599</td>
    </tr>
    <tr>
      <th>365640</th>
      <td>rs149733995</td>
    </tr>
    <tr>
      <th>365641</th>
      <td>rs143849140</td>
    </tr>
    <tr>
      <th>365642</th>
      <td>rs140611932</td>
    </tr>
    <tr>
      <th>365643</th>
      <td>rs181833046</td>
    </tr>
  </tbody>
</table>
<p>365644 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

