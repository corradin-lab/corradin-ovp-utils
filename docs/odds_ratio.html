---

title: Calculating Odds Ratio


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "04_odds_ratio.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_odds_ratio.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geno_each_sample</span> <span class="o">=</span> <span class="n">test_data_catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;geno_each_sample&quot;</span><span class="p">)</span>
<span class="n">case_geno_each_sample</span> <span class="o">=</span> <span class="n">test_data_catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;case_geno_each_sample&quot;</span><span class="p">)</span>
<span class="n">control_geno_each_sample</span> <span class="o">=</span> <span class="n">test_data_catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;control_geno_each_sample&quot;</span><span class="p">)</span>

<span class="n">all_geno_df</span> <span class="o">=</span> <span class="n">test_data_catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;all_geno_df&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geno_each_sample</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>rs1014626</th>
      <th>rs9610458</th>
      <th>rs5762201</th>
      <th>rs1004237</th>
      <th>rs134490</th>
      <th>rs4821519</th>
      <th>rs1003500</th>
      <th>rs5756405</th>
    </tr>
    <tr>
      <th>sample_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>WTCCCT473540</th>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>NaN</td>
      <td>GG</td>
      <td>CC</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>WTCCCT473530</th>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>CG</td>
      <td>CC</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>WTCCCT473555</th>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>NaN</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>WTCCCT473426</th>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>WTCCCT473489</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>NaN</td>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>WS574632</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>WS574661</th>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>BLOOD294452</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>WTCCCT511021</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>WTCCCT510948</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
    </tr>
  </tbody>
</table>
<p>14947 rows Ã— 9 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geno_each_sample</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;rs77948203&#39;, &#39;rs1014626&#39;, &#39;rs9610458&#39;, &#39;rs5762201&#39;, &#39;rs1004237&#39;,
       &#39;rs134490&#39;, &#39;rs4821519&#39;, &#39;rs1003500&#39;, &#39;rs5756405&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RsidComboInfo" class="doc_header"><code>class</code> <code>RsidComboInfo</code><a href="https://github.com/corradin-lab/corradin_ovp_utils/tree/master/ #https://github.com/hoangthienan95/corradin_ovp_utils/tree/master/corradin_ovp_utils/odds_ratio.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RsidComboInfo</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>rsid_list</code></strong>:<code>List</code>[<code>str</code>], <strong><code>NA_val</code></strong>:<code>str</code>)</p>
</blockquote>
<p>RsidComboInfo(df: pandas.core.frame.DataFrame, rsid_list: List[str], NA_val: str)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_geno_combination_df" class="doc_header"><code>get_geno_combination_df</code><a href="https://github.com/corradin-lab/corradin_ovp_utils/tree/master/ #https://github.com/hoangthienan95/corradin_ovp_utils/tree/master/corradin_ovp_utils/odds_ratio.py#L43" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_geno_combination_df</code>(<strong><code>geno_each_sample_df</code></strong>:<code>DataFrame</code>, <strong><code>rsid_list</code></strong>:<code>List</code>[<code>str</code>], <strong><code>NA_val</code></strong>=<em><code>'NA'</code></em>, <strong><code>as_df</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_rsid_info_obj</span> <span class="o">=</span> <span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">])</span>
<span class="n">test_rsid_info_obj</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RsidComboInfo(rsid_list=[&#39;rs77948203&#39;], NA_val=&#39;NA&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_rsid_info_obj</span><span class="o">.</span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>[WTCCCT474448, WTCCCT474394, WTCCCT474560, WTC...</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AG</td>
      <td>[WTCCCT473522, WTCCCT473497, WTCCCT473524, WTC...</td>
      <td>1945</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GG</td>
      <td>[WTCCCT473540, WTCCCT473530, WTCCCT473555, WTC...</td>
      <td>12924</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">test_rsid_info_obj</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">)[</span><span class="s2">&quot;sample_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;unique_samples_id&quot;</span><span class="p">:</span><span class="s2">&quot;unique&quot;</span><span class="p">,</span> <span class="s2">&quot;unique_samples_count&quot;</span><span class="p">:</span> <span class="s2">&quot;nunique&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">test_rsid_info_obj</span><span class="o">.</span><span class="n">rsid_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;rs77948203&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">rs77948203</span><span class="o">=</span><span class="s1">&#39;AA&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>[WTCCCT474448, WTCCCT474394, WTCCCT474560, WTC...</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>rs1014626</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>TT</td>
      <td>[WTCCCT474448, WTCCCT474394, WTCCCT474560, WTC...</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AG</td>
      <td>CT</td>
      <td>[WTCCCT451162, WTCCCT476263]</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AG</td>
      <td>NA</td>
      <td>[WTCCCT508004]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AG</td>
      <td>TT</td>
      <td>[WTCCCT473522, WTCCCT473497, WTCCCT473524, WTC...</td>
      <td>1942</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GG</td>
      <td>CT</td>
      <td>[WTCCCT489603, WTCCCT470545, WTCCCT465946, WTC...</td>
      <td>39</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GG</td>
      <td>NA</td>
      <td>[WTCCCT473298, WTCCCT465970, WTCCCT466158, WTC...</td>
      <td>10</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GG</td>
      <td>TT</td>
      <td>[WTCCCT473540, WTCCCT473530, WTCCCT473555, WTC...</td>
      <td>12875</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">get_all_genos</span><span class="p">(</span><span class="s2">&quot;rs1014626&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;TT&#39;, &#39;CT&#39;, &#39;NA&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can query multiple genotypes by passing in keyword arguments or a dictionary</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">query_result_1</span> <span class="o">=</span> <span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">rs77948203</span><span class="o">=</span> <span class="s1">&#39;AG&#39;</span><span class="p">,</span> <span class="n">rs1014626</span><span class="o">=</span> <span class="s1">&#39;TT&#39;</span><span class="p">)</span>
<span class="n">query_result_1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>rs1014626</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>AG</td>
      <td>TT</td>
      <td>[WTCCCT473522, WTCCCT473497, WTCCCT473524, WTC...</td>
      <td>1942</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">query_result_2</span> <span class="o">=</span> <span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">:</span> <span class="s1">&#39;AG&#39;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">:</span> <span class="s1">&#39;TT&#39;</span><span class="p">})</span>
<span class="n">query_result_2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>rs1014626</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>AG</td>
      <td>TT</td>
      <td>[WTCCCT473522, WTCCCT473497, WTCCCT473524, WTC...</td>
      <td>1942</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">query_result_1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">query_result_2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Querying an unknown rsid will lead to an error</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExceptionExpected</span><span class="p">(</span><span class="n">ex</span><span class="o">=</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="s2">&quot;Some Rsid are not in the dataframe&quot;</span><span class="p">):</span><span class="n">test_rsid_info_obj</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">rs7794820</span><span class="o">=</span><span class="s1">&#39;AA&#39;</span><span class="p">)</span> <span class="c1">#missing the last digit of rsid</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">rs77948203</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can choose to return a simple dataframe, or an object that has enhanced capabilities</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs1014626</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CT</td>
      <td>[WTCCCT489603, WTCCCT470545, WTCCCT465946, WTC...</td>
      <td>41</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NA</td>
      <td>[WTCCCT508004, WTCCCT473298, WTCCCT465970, WTC...</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TT</td>
      <td>[WTCCCT473540, WTCCCT473530, WTCCCT473555, WTC...</td>
      <td>14895</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs1014626&quot;</span><span class="p">],</span> <span class="n">as_df</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs1014626</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CT</td>
      <td>[WTCCCT489603, WTCCCT470545, WTCCCT465946, WTC...</td>
      <td>41</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NA</td>
      <td>[WTCCCT508004, WTCCCT473298, WTCCCT465970, WTC...</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TT</td>
      <td>[WTCCCT473540, WTCCCT473530, WTCCCT473555, WTC...</td>
      <td>14895</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs1014626&quot;</span><span class="p">],</span> <span class="n">as_df</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_geno_combination_df</span> <span class="o">=</span> <span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span>
<span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>rs1014626</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>TT</td>
      <td>[WTCCCT474448, WTCCCT474394, WTCCCT474560, WTC...</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AG</td>
      <td>CT</td>
      <td>[WTCCCT451162, WTCCCT476263]</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AG</td>
      <td>NA</td>
      <td>[WTCCCT508004]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AG</td>
      <td>TT</td>
      <td>[WTCCCT473522, WTCCCT473497, WTCCCT473524, WTC...</td>
      <td>1942</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GG</td>
      <td>CT</td>
      <td>[WTCCCT489603, WTCCCT470545, WTCCCT465946, WTC...</td>
      <td>39</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GG</td>
      <td>NA</td>
      <td>[WTCCCT473298, WTCCCT465970, WTCCCT466158, WTC...</td>
      <td>10</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GG</td>
      <td>TT</td>
      <td>[WTCCCT473540, WTCCCT473530, WTCCCT473555, WTC...</td>
      <td>12875</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">num_samples_NA</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>11</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">NA_samples_df</span> <span class="o">=</span> <span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">]]</span> <span class="o">==</span> <span class="s2">&quot;NA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">NA_samples_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>rs1014626</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>AG</td>
      <td>NA</td>
      <td>[WTCCCT508004]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GG</td>
      <td>NA</td>
      <td>[WTCCCT473298, WTCCCT465970, WTCCCT466158, WTC...</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">total_samples_with_NA</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>14947</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">num_samples_NA</span><span class="p">,</span> <span class="n">NA_samples_df</span><span class="p">[</span><span class="s2">&quot;unique_samples_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">num_samples_NA</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> 
<span class="n">test_eq</span><span class="p">(</span><span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">total_samples_with_NA</span><span class="p">,</span> <span class="mi">14947</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">test_geno_combination_df</span><span class="o">.</span><span class="n">total_samples_no_NA</span><span class="p">,</span> <span class="mi">14936</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">,</span> <span class="s2">&quot;rs134490&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RsidComboInfo(rsid_list=[&#39;rs77948203&#39;, &#39;rs1014626&#39;, &#39;rs134490&#39;], NA_val=&#39;NA&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">control_geno_each_sample</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>rs1014626</th>
      <th>rs9610458</th>
      <th>rs5762201</th>
      <th>rs1004237</th>
      <th>rs134490</th>
      <th>rs4821519</th>
      <th>rs1003500</th>
      <th>rs5756405</th>
    </tr>
    <tr>
      <th>ID_2</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>WTCCCT443025</th>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>AG</td>
      <td>CC</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>WTCCCT443065</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>WTCCCT443063</th>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>CC</td>
      <td>GG</td>
      <td>CC</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>WTCCCT443026</th>
      <td>GG</td>
      <td>TT</td>
      <td>CC</td>
      <td>GG</td>
      <td>CC</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>WTCCCT443066</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>WS574632</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>GG</td>
    </tr>
    <tr>
      <th>WS574661</th>
      <td>GG</td>
      <td>TT</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>BLOOD294452</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>WTCCCT511021</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>WTCCCT510948</th>
      <td>GG</td>
      <td>TT</td>
      <td>CT</td>
      <td>GG</td>
      <td>CC</td>
      <td>TT</td>
      <td>GG</td>
      <td>CC</td>
      <td>AA</td>
    </tr>
  </tbody>
</table>
<p>5175 rows Ã— 9 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">get_geno_combination_df</span><span class="p">(</span><span class="n">case_geno_each_sample</span><span class="p">,[</span><span class="s2">&quot;rs77948203&quot;</span><span class="p">,</span> <span class="s2">&quot;rs1014626&quot;</span><span class="p">])</span>
<span class="n">test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-58-7a9d0fd7a849&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>test <span class="ansi-blue-fg">=</span> get_geno_combination_df<span class="ansi-blue-fg">(</span>case_geno_each_sample<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;rs77948203&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;rs1014626&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> test

<span class="ansi-green-fg">&lt;ipython-input-13-7de0e7bf0983&gt;</span> in <span class="ansi-cyan-fg">get_geno_combination_df</span><span class="ansi-blue-fg">(geno_each_sample_df, rsid_list, NA_val, as_df)</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span> <span class="ansi-green-fg">def</span> get_geno_combination_df<span class="ansi-blue-fg">(</span>geno_each_sample_df<span class="ansi-blue-fg">:</span> pd<span class="ansi-blue-fg">.</span>DataFrame<span class="ansi-blue-fg">,</span> rsid_list<span class="ansi-blue-fg">:</span>List<span class="ansi-blue-fg">[</span>str<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> NA_val<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;NA&#34;</span><span class="ansi-blue-fg">,</span> as_df<span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     34</span>     <span class="ansi-red-fg">#geno_each_sample_df[[&#34;rs77948203&#34;, &#34;rs1014626&#34;, &#34;rs1004237&#34;]].reset_index().groupby([&#34;rs77948203&#34;, &#34;rs1014626&#34;, &#34;rs1004237&#34;])[&#34;sample_id&#34;].unique().reset_index()</span>
<span class="ansi-green-fg">---&gt; 35</span><span class="ansi-red-fg">     </span>geno_combination_df <span class="ansi-blue-fg">=</span> geno_each_sample_df<span class="ansi-blue-fg">[</span>rsid_list<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>fillna<span class="ansi-blue-fg">(</span>NA_val<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>reset_index<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>groupby<span class="ansi-blue-fg">(</span>rsid_list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;sample_id&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>agg<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span><span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">&#34;unique_samples_id&#34;</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">&#34;unique&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;unique_samples_count&#34;</span><span class="ansi-blue-fg">:</span> <span class="ansi-blue-fg">&#34;nunique&#34;</span><span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>reset_index<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     36</span>     <span class="ansi-green-fg">if</span> as_df<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     37</span>         <span class="ansi-green-fg">return</span> geno_combination_df

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/groupby/generic.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   1540</span>                 stacklevel<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1541</span>             )
<span class="ansi-green-fg">-&gt; 1542</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__getitem__<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1543</span> 
<span class="ansi-green-intense-fg ansi-bold">   1544</span>     <span class="ansi-green-fg">def</span> _gotitem<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> key<span class="ansi-blue-fg">,</span> ndim<span class="ansi-blue-fg">:</span> int<span class="ansi-blue-fg">,</span> subset<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/lab/corradin_biobank/FOR_AN/OVP/corradin_ovp_utils/.venv/lib/python3.8/site-packages/pandas/core/base.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    278</span>             <span class="ansi-red-fg"># error: &#34;SelectionMixin&#34; has no attribute &#34;obj&#34;  [attr-defined]</span>
<span class="ansi-green-intense-fg ansi-bold">    279</span>             <span class="ansi-green-fg">if</span> key <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>obj<span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># type: ignore[attr-defined]</span>
<span class="ansi-green-fg">--&gt; 280</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">raise</span> KeyError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#34;Column not found: {key}&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    281</span>             <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_gotitem<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">,</span> ndim<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    282</span> 

<span class="ansi-red-fg">KeyError</span>: &#39;Column not found: sample_id&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rs77948203</th>
      <th>rs1014626</th>
      <th>unique_samples_id</th>
      <th>unique_samples_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>TT</td>
      <td>[sample1445, sample1545, sample2271, sample237...</td>
      <td>46</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AG</td>
      <td>CT</td>
      <td>[sample5663, sample5840]</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AG</td>
      <td>NA</td>
      <td>[sample297]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AG</td>
      <td>TT</td>
      <td>[sample1000, sample1002, sample1025, sample102...</td>
      <td>1224</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GG</td>
      <td>CT</td>
      <td>[sample1264, sample1359, sample1960, sample220...</td>
      <td>26</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GG</td>
      <td>NA</td>
      <td>[sample1378, sample1496, sample2247, sample391...</td>
      <td>8</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GG</td>
      <td>TT</td>
      <td>[sample1, sample10, sample100, sample1001, sam...</td>
      <td>8465</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

